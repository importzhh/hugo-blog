<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="https://www.deeplearning.ai/short-courses/langchain-chat-with-your-data/ æ–‡æ¡£åŠ è½½ æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç» æ–‡æ¡£åŠ è½½å™¨çš„ä½œç”¨ï¼Œæ˜¯å°†ä¸åŒæ ¼å¼å’Œæ¥æºçš„æ•°æ®åŠ è½½åˆ°æ ‡å‡†çš„æ–‡æ¡£å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬å†…å®¹æœ¬èº«ä»¥åŠå…³è”çš„å…ƒæ•°æ®ã€‚ LangChain"><title>III: åŸºäºç§æœ‰æ•°æ®ä½¿ç”¨LangChainæ„å»ºèŠå¤©æœºå™¨äºº</title><link rel=canonical href=https://blog.importzhh.me/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/><link rel=stylesheet href=/scss/style.min.0d8902b26558cddb5286ea49f2a7aadd5761ed898547e29e5ab572d8c0619ba6.css><meta property="og:title" content="III: åŸºäºç§æœ‰æ•°æ®ä½¿ç”¨LangChainæ„å»ºèŠå¤©æœºå™¨äºº"><meta property="og:description" content="https://www.deeplearning.ai/short-courses/langchain-chat-with-your-data/ æ–‡æ¡£åŠ è½½ æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç» æ–‡æ¡£åŠ è½½å™¨çš„ä½œç”¨ï¼Œæ˜¯å°†ä¸åŒæ ¼å¼å’Œæ¥æºçš„æ•°æ®åŠ è½½åˆ°æ ‡å‡†çš„æ–‡æ¡£å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬å†…å®¹æœ¬èº«ä»¥åŠå…³è”çš„å…ƒæ•°æ®ã€‚ LangChain"><meta property="og:url" content="https://blog.importzhh.me/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/"><meta property="og:site_name" content="importzhhçš„å°ç ´ç«™"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="LangChain"><meta property="article:published_time" content="2023-08-30T12:44:47+08:00"><meta property="article:modified_time" content="2023-08-30T12:44:47+08:00"><meta name=twitter:title content="III: åŸºäºç§æœ‰æ•°æ®ä½¿ç”¨LangChainæ„å»ºèŠå¤©æœºå™¨äºº"><meta name=twitter:description content="https://www.deeplearning.ai/short-courses/langchain-chat-with-your-data/ æ–‡æ¡£åŠ è½½ æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç» æ–‡æ¡£åŠ è½½å™¨çš„ä½œç”¨ï¼Œæ˜¯å°†ä¸åŒæ ¼å¼å’Œæ¥æºçš„æ•°æ®åŠ è½½åˆ°æ ‡å‡†çš„æ–‡æ¡£å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬å†…å®¹æœ¬èº«ä»¥åŠå…³è”çš„å…ƒæ•°æ®ã€‚ LangChain"><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_huce6e906a97de2553354850eae15a0392_8624_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>importzhhçš„å°ç ´ç«™</a></h1><h2 class=site-description>å®äº‹æ±‚æ˜¯ æ€å±æ€é€€æ€å˜</h2></div></header><ol class=social-menu><li><a href=https://github.com/importzhh target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="-1.65 0 259.3 259.3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid"><g><path fill="#9edcf2" d="M200.9 199.8c0 13.9-32.2 25.1-71.9 25.1-39.7.0-71.9-11.3-71.9-25.1.0-13.9 32.2-25.1 71.9-25.1C168.7 174.7 200.9 185.9 200.9 199.8zm0 0"/><g><defs><path id="SVGID_1_" d="M98.1 244.8c1.6 7.5 5.5 11.9 9.4 14.5h41.1c5-3.4 10.1-9.8 10.1-21.8v-31s.6-7.7 7.7-10.2c0 0 4.1-2.9-.3-4.5.0.0-19.5-1.6-19.5 14.4v23.6s.8 8.7-3.8 12.3v-29.2s.3-9.3 5.1-12.8c0 0 3.2-5.7-3.8-4.2.0.0-13.4 1.9-14 17.6l-.3 30h-3.2l-.3-30c-.6-15.6-14-17.6-14-17.6-7-1.6-3.8 4.2-3.8 4.2 4.8 3.5 5.1 12.8 5.1 12.8v29.5c-4.6-3.3-3.8-12.6-3.8-12.6v-23.6c0-16-19.5-14.4-19.5-14.4-4.5 1.6-.3 4.5-.3 4.5 7 2.6 7.7 10.2 7.7 10.2v21.7L98.1 244.8z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#7dbce7" d="M200.9 199.8c0 13.9-32.2 25.1-71.9 25.1-39.7.0-71.9-11.3-71.9-25.1.0-13.9 32.2-25.1 71.9-25.1C168.7 174.7 200.9 185.9 200.9 199.8zm0 0"/></g><path fill="#9edcf2" d="M46.9 125.9l-2.1 7.2s-.5 2.6 1.9 3.1c2.6-.1 2.4-2.5 2.2-3.2L46.9 125.9zm0 0"/><path fill="#010101" d="M255.8 95.6l.2-.9c-21.1-4.2-42.7-4.3-55.8-3.7 2.1-7.7 2.8-16.7 2.8-26.6.0-14.3-5.4-25.7-14-34.3 1.5-4.9 3.5-15.8-2-29.7.0.0-9.8-3.1-32.1 11.8-8.7-2.2-18-3.3-27.3-3.3-10.2.0-20.5 1.3-30.2 3.9C74.4-2.9 64.3.3 64.3.3c-6.6 16.5-2.5 28.8-1.3 31.8-7.8 8.4-12.5 19.1-12.5 32.2.0 9.9 1.1 18.8 3.9 26.5-13.2-.5-34-.3-54.4 3.8l.2.9c20.4-4.1 41.4-4.2 54.5-3.7.6 1.6 1.3 3.2 2 4.7-13 .4-35.1 2.1-56.3 8.1l.3.9c21.4-6 43.7-7.6 56.6-8 7.8 14.4 23 23.8 50.2 26.7-3.9 2.6-7.8 7-9.4 14.5-5.3 2.5-21.9 8.7-31.9-8.5.0.0-5.6-10.2-16.3-11 0 0-10.4-.2-.7 6.5.0.0 6.9 3.3 11.7 15.6.0.0 6.3 21 36.4 14.2V177s-.6 7.7-7.7 10.2c0 0-4.2 2.9.3 4.5.0.0 19.5 1.6 19.5-14.4v-23.6s-.8-9.4 3.8-12.6v38.8s-.3 9.3-5.1 12.8c0 0-3.2 5.7 3.8 4.2.0.0 13.4-1.9 14-17.6l.3-39.3h3.2l.3 39.3c.6 15.6 14 17.6 14 17.6 7 1.6 3.8-4.2 3.8-4.2-4.8-3.5-5.1-12.8-5.1-12.8v-38.5c4.6 3.6 3.8 12.3 3.8 12.3v23.6c0 16 19.5 14.4 19.5 14.4 4.5-1.6.3-4.5.3-4.5-7-2.6-7.7-10.2-7.7-10.2v-31c0-12.1-5.1-18.5-10.1-21.8 29-2.9 42.9-12.2 49.3-26.8 12.7.3 35.6 1.9 57.4 8.1l.3-.9c-21.7-6.1-44.4-7.7-57.3-8.1.6-1.5 1.1-3 1.6-4.6C212.9 91.4 234.6 91.4 255.8 95.6zm0 0"/><path fill="#f5ccb3" d="M174.6 63.7c6.2 5.7 9.9 12.5 9.9 19.8.0 34.4-25.6 35.3-57.2 35.3S70.1 114 70.1 83.5c0-7.3 3.6-14.1 9.8-19.7 10.3-9.4 27.7-4.4 47.4-4.4 19.7.0 37-5.1 47.3 4.3zm0 0"/><path fill="#fff" d="M108.3 85.3c0 9.5-5.3 17.1-11.9 17.1-6.6.0-11.9-7.7-11.9-17.1.0-9.5 5.3-17.1 11.9-17.1C103 68.1 108.3 75.8 108.3 85.3zm0 0"/><path fill="#af5c51" d="M104.5 85.5c0 6.3-3.6 11.4-7.9 11.4-4.4.0-7.9-5.1-7.9-11.4.0-6.3 3.6-11.4 7.9-11.4S104.5 79.2 104.5 85.5zm0 0"/><path fill="#fff" d="M172.2 85.3c0 9.5-5.3 17.1-11.9 17.1s-11.9-7.7-11.9-17.1c0-9.5 5.3-17.1 11.9-17.1C166.8 68.1 172.2 75.8 172.2 85.3zm0 0"/><path fill="#af5c51" d="M168.3 85.5c0 6.3-3.6 11.4-7.9 11.4-4.4.0-7.9-5.1-7.9-11.4.0-6.3 3.6-11.4 7.9-11.4C164.8 74.1 168.3 79.2 168.3 85.5zm0 0"/><path fill="#af5c51" d="M130.5 100.5c0 1.6-1.3 3-3 3-1.6.0-3-1.3-3-3s1.3-3 3-3c1.59999999999999.0 3 1.3 3 3zm0 0"/><path fill="#af5c51" d="M120.6 108c-.2-.5.1-1 .6-1.2s1 .1 1.2.6c.8 2.2 2.8 3.6 5.1 3.6s4.3-1.5 5.1-3.6c.2-.5.7-.8 1.2-.6s.8.7.6 1.2c-1 2.9-3.8 4.9-6.9 4.9C124.4 112.9 121.6 110.9 120.6 108zm0 0"/><path fill="#c4e5d9" d="M54.5 121.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4.0-.8.9-1.4 2.1-1.4C53.6 120.2 54.5 120.8 54.5 121.6zm0 0"/><path fill="#c4e5d9" d="M60.3 124.8c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4.0-.8.9-1.4 2.1-1.4C59.4 123.4 60.3 124 60.3 124.8zm0 0"/><path fill="#c4e5d9" d="M63.8 129c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C62.9 127.5 63.8 128.2 63.8 129zm0 0"/><path fill="#c4e5d9" d="M67 133.8c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C66.1 132.3 67 133 67 133.8zm0 0"/><path fill="#c4e5d9" d="M70.5 138.2c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C69.6 136.8 70.5 137.4 70.5 138.2zm0 0"/><path fill="#c4e5d9" d="M75.3 142.1c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C74.4 140.6 75.3 141.3 75.3 142.1zm0 0"/><path fill="#c4e5d9" d="M82 144.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4S82 143.8 82 144.6zm0 0"/><path fill="#c4e5d9" d="M88.7 144.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4S88.7 143.8 88.7 144.6zm0 0"/><path fill="#c4e5d9" d="M95.5 143.5c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C94.5 142.1 95.5 142.7 95.5 143.5zm0 0"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#æ–‡æ¡£åŠ è½½>æ–‡æ¡£åŠ è½½</a><ol><li><a href=#æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç»>æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç»</a></li></ol></li><li><a href=#åŠ è½½pdfæ–‡æ¡£>åŠ è½½PDFæ–‡æ¡£</a></li><li><a href=#åŠ è½½youtubeè§†é¢‘>åŠ è½½YouTubeè§†é¢‘</a><ol><li><a href=#æ­¥éª¤1å¯¼å…¥å‡ ä¸ªå…³é”®éƒ¨åˆ†åŒ…æ‹¬>æ­¥éª¤1ï¼šå¯¼å…¥å‡ ä¸ªå…³é”®éƒ¨åˆ†ï¼ŒåŒ…æ‹¬</a></li><li><a href=#æ­¥éª¤2æŒ‡å®šurlåŠä¿å­˜éŸ³é¢‘æ–‡ä»¶çš„ç›®å½•åˆ›å»ºç»„åˆäº†æ­¥éª¤1ä¸¤ä¸ªå…³é”®éƒ¨åˆ†çš„é€šç”¨åŠ è½½å™¨å¹¶æ‰§è¡ŒåŠ è½½>æ­¥éª¤2ï¼šæŒ‡å®šURLåŠä¿å­˜éŸ³é¢‘æ–‡ä»¶çš„ç›®å½•ï¼Œåˆ›å»ºç»„åˆäº†æ­¥éª¤1ä¸¤ä¸ªå…³é”®éƒ¨åˆ†çš„é€šç”¨åŠ è½½å™¨å¹¶æ‰§è¡ŒåŠ è½½</a></li><li><a href=#æ­¥éª¤3æŸ¥çœ‹åŠ è½½å®Œæˆçš„è§†é¢‘æ–‡ç¨¿>æ­¥éª¤3ï¼šæŸ¥çœ‹åŠ è½½å®Œæˆçš„è§†é¢‘æ–‡ç¨¿</a></li></ol></li><li><a href=#åŠ è½½ç½‘ç»œurl>åŠ è½½ç½‘ç»œURL</a></li><li><a href=#æ–‡æ¡£åˆ†å‰²>æ–‡æ¡£åˆ†å‰²</a></li><li><a href=#æ–‡æ¡£åˆ†å‰²çš„é‡è¦æ€§>æ–‡æ¡£åˆ†å‰²çš„é‡è¦æ€§</a></li><li><a href=#æ–‡æ¡£åˆ†å‰²çš„æ–¹å¼>æ–‡æ¡£åˆ†å‰²çš„æ–¹å¼</a></li><li><a href=#åŸºäºå­—ç¬¦çš„åˆ†å‰²>åŸºäºå­—ç¬¦çš„åˆ†å‰²</a><ol><li><a href=#æ­¥éª¤1å¯¼å…¥æ–‡æœ¬åˆ†å‰²å™¨>æ­¥éª¤1ï¼šå¯¼å…¥æ–‡æœ¬åˆ†å‰²å™¨</a></li><li><a href=#æ­¥éª¤2è®¾å®šå—å¤§å°å’Œå—é‡å å¤§å°>æ­¥éª¤2ï¼šè®¾å®šå—å¤§å°å’Œå—é‡å å¤§å°</a></li><li><a href=#æ­¥éª¤3åˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨>æ­¥éª¤3ï¼šåˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨</a></li><li><a href=#æ­¥éª¤4ä½¿ç”¨ä¸åŒçš„åˆ†å‰²å™¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²>æ­¥éª¤4ï¼šä½¿ç”¨ä¸åŒçš„åˆ†å‰²å™¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²</a><ol><li><a href=#é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨>é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</a></li><li><a href=#å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨>å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</a></li></ol></li><li><a href=#æ­¥éª¤5é€’å½’åˆ†å‰²é•¿æ®µè½>æ­¥éª¤5ï¼šé€’å½’åˆ†å‰²é•¿æ®µè½</a></li></ol></li><li><a href=#åŸºäºtokençš„åˆ†å‰²>åŸºäºTokençš„åˆ†å‰²</a></li><li><a href=#åˆ†å‰²markdownæ–‡æ¡£>åˆ†å‰²Markdownæ–‡æ¡£</a><ol><li><a href=#æ­¥éª¤1å®šä¹‰ä¸€ä¸ªmarkdownæ–‡æ¡£>æ­¥éª¤1ï¼šå®šä¹‰ä¸€ä¸ªMarkdownæ–‡æ¡£</a></li><li><a href=#æ­¥éª¤2å®šä¹‰æƒ³è¦åˆ†å‰²çš„æ ‡é¢˜åˆ—è¡¨å’Œåç§°>æ­¥éª¤2ï¼šå®šä¹‰æƒ³è¦åˆ†å‰²çš„æ ‡é¢˜åˆ—è¡¨å’Œåç§°</a></li><li><a href=#æ­¥éª¤3åˆå§‹åŒ–markdownæ ‡é¢˜æ–‡æœ¬åˆ‡åˆ†å™¨åˆ†å‰²markdownæ–‡æ¡£>æ­¥éª¤3ï¼šåˆå§‹åŒ–Markdownæ ‡é¢˜æ–‡æœ¬åˆ‡åˆ†å™¨ï¼Œåˆ†å‰²Markdownæ–‡æ¡£</a></li></ol></li><li><a href=#å‘é‡å­˜å‚¨å’ŒåµŒå…¥>å‘é‡å­˜å‚¨å’ŒåµŒå…¥</a><ol><li><a href=#æ­¥éª¤1æä¾›ä¸€äº›ä¾‹å¥å…¶ä¸­å‰ä¸¤å¥éå¸¸ç›¸ä¼¼ç¬¬ä¸‰å¥åˆ™ä¸å‰ä¸¤å¥å…³è”ä¸å¤§>æ­¥éª¤1ï¼šæä¾›ä¸€äº›ä¾‹å¥ï¼Œå…¶ä¸­å‰ä¸¤å¥éå¸¸ç›¸ä¼¼ï¼Œç¬¬ä¸‰å¥åˆ™ä¸å‰ä¸¤å¥å…³è”ä¸å¤§</a></li><li><a href=#æ­¥éª¤2ä½¿ç”¨embbedingç±»ä¸ºæ¯ä¸ªå¥å­ç”Ÿæˆä¸€ä¸ªåµŒå…¥>æ­¥éª¤2ï¼šä½¿ç”¨Embbedingç±»ä¸ºæ¯ä¸ªå¥å­ç”Ÿæˆä¸€ä¸ªåµŒå…¥</a></li><li><a href=#æ­¥éª¤3ç”¨ç‚¹ç§¯dot-productæ¥è®¡ç®—ä¸¤ä¸¤ä¹‹é—´çš„åµŒå…¥ç›¸ä¼¼åº¦>æ­¥éª¤3ï¼šç”¨ç‚¹ç§¯(dot product)æ¥è®¡ç®—ä¸¤ä¸¤ä¹‹é—´çš„åµŒå…¥ç›¸ä¼¼åº¦</a></li><li><a href=#æ­¥éª¤1åŠ è½½pdfæ–‡æ¡£>æ­¥éª¤1ï¼šåŠ è½½PDFæ–‡æ¡£</a></li><li><a href=#æ­¥éª¤2ç”¨é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨æ¥æŠŠæ–‡æ¡£åˆ†æˆå—>æ­¥éª¤2ï¼šç”¨é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨æ¥æŠŠæ–‡æ¡£åˆ†æˆå—</a></li><li><a href=#æ­¥éª¤3ä¸ºæ¯ä¸ªå—ç”ŸæˆåµŒå…¥å¹¶åˆ›å»ºchromaå‘é‡å­˜å‚¨>æ­¥éª¤3ï¼šä¸ºæ¯ä¸ªå—ç”ŸæˆåµŒå…¥ï¼Œå¹¶åˆ›å»ºChromaå‘é‡å­˜å‚¨</a></li><li><a href=#æ­¥éª¤4ç”¨ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•æ¥æŸ¥æ‰¾æ–‡æ¡£>æ­¥éª¤4ï¼šç”¨ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•æ¥æŸ¥æ‰¾æ–‡æ¡£</a></li><li><a href=#æ­¥éª¤5æŒä¹…åŒ–å‘é‡æ•°æ®åº“ä»¥ä¾¿ä»¥åä½¿ç”¨>æ­¥éª¤5ï¼šæŒä¹…åŒ–å‘é‡æ•°æ®åº“ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨</a></li><li><a href=#å¤±è´¥æƒ…å†µ1é‡å¤çš„å—å¯¼è‡´é‡å¤çš„å†—ä½™ä¿¡æ¯>å¤±è´¥æƒ…å†µ1ï¼šé‡å¤çš„å—å¯¼è‡´é‡å¤çš„å†—ä½™ä¿¡æ¯</a></li><li><a href=#å¤±è´¥æƒ…å†µ2æ— æ³•å®Œæ•´æ•æ‰åˆ°é—®é¢˜ä¸­çš„å…³é”®ä¿¡æ¯>å¤±è´¥æƒ…å†µ2ï¼šæ— æ³•å®Œæ•´æ•æ‰åˆ°é—®é¢˜ä¸­çš„å…³é”®ä¿¡æ¯</a></li><li><a href=#å¤±è´¥æƒ…å†µ3éšç€æ£€ç´¢æ–‡æ¡£æ•°é‡çš„å¢åŠ ç›¸å…³æ€§é€æ¸é™ä½>å¤±è´¥æƒ…å†µ3ï¼šéšç€æ£€ç´¢æ–‡æ¡£æ•°é‡çš„å¢åŠ ï¼Œç›¸å…³æ€§é€æ¸é™ä½</a></li></ol></li><li><a href=#æ£€ç´¢>æ£€ç´¢</a></li><li><a href=#è§£å†³å¤šæ ·æ€§æœ€å¤§è¾¹ç¼˜ç›¸å…³æ€§>è§£å†³å¤šæ ·æ€§ï¼šæœ€å¤§è¾¹ç¼˜ç›¸å…³æ€§</a><ol><li><a href=#æ­¥éª¤1åˆ›å»ºchromaå‘é‡å­˜å‚¨>æ­¥éª¤1ï¼šåˆ›å»ºChromaå‘é‡å­˜å‚¨</a></li><li><a href=#æ­¥éª¤2ç”¨å°‘é‡ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå°å‹æ•°æ®åº“>æ­¥éª¤2ï¼šç”¨å°‘é‡ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå°å‹æ•°æ®åº“</a></li><li><a href=#æ­¥éª¤3è¿›è¡Œç›¸ä¼¼æ€§æœç´¢>æ­¥éª¤3ï¼šè¿›è¡Œç›¸ä¼¼æ€§æœç´¢</a></li><li><a href=#æ­¥éª¤4è¿›è¡Œmmræœç´¢>æ­¥éª¤4ï¼šè¿›è¡ŒMMRæœç´¢</a></li></ol></li><li><a href=#è§£å†³ç‰¹æ®Šæ€§ä½¿ç”¨è‡ªæŸ¥è¯¢æ£€ç´¢å™¨å¤„ç†å…ƒæ•°æ®>è§£å†³ç‰¹æ®Šæ€§ï¼šä½¿ç”¨è‡ªæŸ¥è¯¢æ£€ç´¢å™¨å¤„ç†å…ƒæ•°æ®</a><ol><li><a href=#æ­¥éª¤1æä¾›å…ƒæ•°æ®å­—æ®µä¿¡æ¯>æ­¥éª¤1ï¼šæä¾›å…ƒæ•°æ®å­—æ®µä¿¡æ¯</a></li><li><a href=#æ­¥éª¤2åˆå§‹åŒ–è‡ªæŸ¥è¯¢æ£€ç´¢å™¨>æ­¥éª¤2ï¼šåˆå§‹åŒ–è‡ªæŸ¥è¯¢æ£€ç´¢å™¨</a></li><li><a href=#æ­¥éª¤3è¿è¡Œè‡ªæŸ¥è¯¢æ£€ç´¢å™¨æœç´¢é—®é¢˜>æ­¥éª¤3ï¼šè¿è¡Œè‡ªæŸ¥è¯¢æ£€ç´¢å™¨æœç´¢é—®é¢˜</a></li></ol></li><li><a href=#è§£å†³ç›¸å…³æ€§ä½¿ç”¨ä¸Šä¸‹æ–‡å‹ç¼©æå–å‡ºä¸æŸ¥è¯¢æœ€ç›¸å…³çš„éƒ¨åˆ†>è§£å†³ç›¸å…³æ€§ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡å‹ç¼©æå–å‡ºä¸æŸ¥è¯¢æœ€ç›¸å…³çš„éƒ¨åˆ†</a><ol><li><a href=#æ­¥éª¤1åˆ›å»ºä¸Šä¸‹æ–‡å‹ç¼©æ£€ç´¢å™¨>æ­¥éª¤1ï¼šåˆ›å»ºä¸Šä¸‹æ–‡å‹ç¼©æ£€ç´¢å™¨</a></li><li><a href=#æ­¥éª¤2æå‡ºé—®é¢˜æ£€ç´¢å‹ç¼©åçš„ç›¸å…³æ–‡æ¡£>æ­¥éª¤2ï¼šæå‡ºé—®é¢˜ï¼Œæ£€ç´¢å‹ç¼©åçš„ç›¸å…³æ–‡æ¡£</a></li></ol></li><li><a href=#é—®ç­”>é—®ç­”</a></li><li><a href=#stuff>stuff</a><ol><li><a href=#æ­¥éª¤1åŠ è½½ä¹‹å‰ä¿å­˜çš„å‘é‡æ•°æ®åº“>æ­¥éª¤1ï¼šåŠ è½½ä¹‹å‰ä¿å­˜çš„å‘é‡æ•°æ®åº“</a></li><li><a href=#æ­¥éª¤2åˆå§‹åŒ–å°†ç”¨äºå›ç­”é—®é¢˜çš„è¯­è¨€æ¨¡å‹>æ­¥éª¤2ï¼šåˆå§‹åŒ–å°†ç”¨äºå›ç­”é—®é¢˜çš„è¯­è¨€æ¨¡å‹</a></li><li><a href=#æ­¥éª¤3å¯¼å…¥åˆ›å»ºè°ƒç”¨æ£€ç´¢é—®ç­”é“¾è¾“å…¥é—®é¢˜å¹¶è·å–ç­”æ¡ˆ>æ­¥éª¤3ï¼šå¯¼å…¥ã€åˆ›å»ºã€è°ƒç”¨æ£€ç´¢é—®ç­”é“¾ï¼Œè¾“å…¥é—®é¢˜ï¼Œå¹¶è·å–ç­”æ¡ˆ</a></li><li><a href=#æ­¥éª¤4ä½¿ç”¨æç¤ºæ¨¡æ¿ä¼˜åŒ–è¾“å‡ºç»“æœ>æ­¥éª¤4ï¼šä½¿ç”¨æç¤ºæ¨¡æ¿ä¼˜åŒ–è¾“å‡ºç»“æœ</a></li><li><a href=#æ­¥éª¤5æŸ¥çœ‹è¿”å›çš„æºæ–‡æ¡£ç†è§£å…¶ä»å“ªé‡Œè·å–æ•°æ®>æ­¥éª¤5ï¼šæŸ¥çœ‹è¿”å›çš„æºæ–‡æ¡£ï¼Œç†è§£å…¶ä»å“ªé‡Œè·å–æ•°æ®</a></li></ol></li><li><a href=#map-reduce>Map-reduce</a><ol><li><a href=#ä½¿ç”¨langsmithå¹³å°äº†è§£è¿™äº›é“¾å†…éƒ¨çš„è°ƒç”¨æƒ…å†µ>ä½¿ç”¨LangSmithå¹³å°äº†è§£è¿™äº›é“¾å†…éƒ¨çš„è°ƒç”¨æƒ…å†µ</a></li></ol></li><li><a href=#refine>Refine</a></li><li><a href=#chat>Chat</a><ol><li><a href=#æ­¥éª¤1åˆå§‹åŒ–ç”¨äºä¿å­˜å¤§é‡æ–‡æ¡£å†…å®¹çš„å‘é‡æ•°æ®åº“>æ­¥éª¤1ï¼šåˆå§‹åŒ–ç”¨äºä¿å­˜å¤§é‡æ–‡æ¡£å†…å®¹çš„å‘é‡æ•°æ®åº“</a></li><li><a href=#æ­¥éª¤2åˆå§‹åŒ–å°†ä½œä¸ºèŠå¤©æœºå™¨äººä½¿ç”¨çš„è¯­è¨€æ¨¡å‹>æ­¥éª¤2ï¼šåˆå§‹åŒ–å°†ä½œä¸ºèŠå¤©æœºå™¨äººä½¿ç”¨çš„è¯­è¨€æ¨¡å‹</a></li><li><a href=#æ­¥éª¤3åˆå§‹åŒ–æç¤ºæ¨¡æ¿è®©è¾“å‡ºç»“æœæ›´ç®€ä»‹æ›´å°‘ç¼–é€ æ›´ç¤¼è²Œ>æ­¥éª¤3ï¼šåˆå§‹åŒ–æç¤ºæ¨¡æ¿ï¼Œè®©è¾“å‡ºç»“æœæ›´ç®€ä»‹ã€æ›´å°‘ç¼–é€ ã€æ›´ç¤¼è²Œ</a></li><li><a href=#æ­¥éª¤4åˆ›å»ºæ£€ç´¢qaé“¾ç”¨äºåˆå¹¶æ£€ç´¢åˆ°çš„æ–‡æœ¬ç‰‡æ®µå¹¶è°ƒç”¨è¯­è¨€æ¨¡å‹>æ­¥éª¤4ï¼šåˆ›å»ºæ£€ç´¢QAé“¾ï¼Œç”¨äºåˆå¹¶æ£€ç´¢åˆ°çš„æ–‡æœ¬ç‰‡æ®µå¹¶è°ƒç”¨è¯­è¨€æ¨¡å‹</a></li><li><a href=#æ­¥éª¤5ä½¿ç”¨conversationbuffermemoryå¢åŠ èŠå¤©æœºå™¨äººçš„è®°å¿†åŠŸèƒ½>æ­¥éª¤5ï¼šä½¿ç”¨ConversationBufferMemoryå¢åŠ èŠå¤©æœºå™¨äººçš„è®°å¿†åŠŸèƒ½</a></li><li><a href=#æ­¥éª¤6åˆ›å»ºconversationalretrievalchainå¯¹è¯æ£€ç´¢é“¾ä¼ å…¥è¯­è¨€æ¨¡å‹æ£€ç´¢å™¨å’Œè®°å¿†ç³»ç»Ÿ>æ­¥éª¤6ï¼šåˆ›å»ºConversationalRetrievalChainï¼ˆå¯¹è¯æ£€ç´¢é“¾ï¼‰ï¼Œä¼ å…¥è¯­è¨€æ¨¡å‹ã€æ£€ç´¢å™¨å’Œè®°å¿†ç³»ç»Ÿ</a></li><li><a href=#æ­¥éª¤7ä½¿ç”¨pypdfloaderåŠ è½½æ‰€è¦å‚è€ƒçš„æ–‡æ¡£>æ­¥éª¤7ï¼šä½¿ç”¨PyPDFLoaderåŠ è½½æ‰€è¦å‚è€ƒçš„æ–‡æ¡£</a></li><li><a href=#æ­¥éª¤8åˆ†å‰²æ–‡æ¡£ä¸ºæ¯ä¸ªåˆ†å—åˆ›å»ºåµŒå…¥å¹¶å­˜å‚¨åˆ°å‘é‡å­˜å‚¨åº“ä¸­>æ­¥éª¤8ï¼šåˆ†å‰²æ–‡æ¡£ï¼Œä¸ºæ¯ä¸ªåˆ†å—åˆ›å»ºåµŒå…¥ï¼Œå¹¶å­˜å‚¨åˆ°å‘é‡å­˜å‚¨åº“ä¸­ã€‚</a></li><li><a href=#æ­¥éª¤9ä»å‘é‡æ•°æ®åº“åˆ›å»ºä¸€ä¸ªåŸºäºç›¸ä¼¼åº¦çš„æ£€ç´¢å™¨>æ­¥éª¤9ï¼šä»å‘é‡æ•°æ®åº“åˆ›å»ºä¸€ä¸ªåŸºäºâ€œç›¸ä¼¼åº¦â€çš„æ£€ç´¢å™¨ã€‚</a></li><li><a href=#æ­¥éª¤10åˆ›å»ºå¯¹è¯æ£€ç´¢é“¾ç”¨äºå°†èŠå¤©å†å²å’Œæ–°æçš„é—®é¢˜æ•´åˆæˆä¸€ä¸ªæ–°çš„ç‹¬ç«‹é—®é¢˜>æ­¥éª¤10ï¼šåˆ›å»ºå¯¹è¯æ£€ç´¢é“¾ï¼Œç”¨äºå°†èŠå¤©å†å²å’Œæ–°æçš„é—®é¢˜æ•´åˆæˆä¸€ä¸ªæ–°çš„ç‹¬ç«‹é—®é¢˜</a></li><li><a href=#æ­¥éª¤11æä¾›ä¸€ä¸ªä¸èŠå¤©æœºå™¨äººäº¤äº’çš„ç”¨æˆ·ç•Œé¢>æ­¥éª¤11ï¼šæä¾›ä¸€ä¸ªä¸èŠå¤©æœºå™¨äººäº¤äº’çš„ç”¨æˆ·ç•Œé¢</a></li><li><a href=#æ­¥éª¤12åœ¨è¿è¡Œèµ·æ¥çš„ç”¨æˆ·ç•Œé¢ä¸Šè¿›è¡Œå®é™…çš„é—®ç­”å¯¹è¯>æ­¥éª¤12ï¼šåœ¨è¿è¡Œèµ·æ¥çš„ç”¨æˆ·ç•Œé¢ä¸Šè¿›è¡Œå®é™…çš„é—®ç­”å¯¹è¯ã€‚</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/chatgpt/>chatgpt</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/>III: åŸºäºç§æœ‰æ•°æ®ä½¿ç”¨LangChainæ„å»ºèŠå¤©æœºå™¨äºº</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Aug 30, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é˜…è¯»æ—¶é•¿: 21 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p><a class=link href=https://www.deeplearning.ai/short-courses/langchain-chat-with-your-data/ target=_blank rel=noopener>https://www.deeplearning.ai/short-courses/langchain-chat-with-your-data/</a></p><div class=video-wrapper><iframe src="https://player.bilibili.com/player.html?as_wide=1&amp;high_quality=1&amp;page=1&bvid=BV148411D7d2" scrolling=no frameborder=no framespacing=0 allowfullscreen></iframe></div><h2 id=æ–‡æ¡£åŠ è½½>æ–‡æ¡£åŠ è½½</h2><h3 id=æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç»>æ–‡æ¡£åŠ è½½å™¨çš„ä»‹ç»</h3><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.52.56.png width=2660 height=1534 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.52.56_hu35b481662af1b15e039db616f3621f6d_1037567_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.52.56_hu35b481662af1b15e039db616f3621f6d_1037567_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=173 data-flex-basis=416px></p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.55.22.png width=1818 height=1506 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.55.22_huffd446c3382fce7d2972a3e463126577_748380_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_21.55.22_huffd446c3382fce7d2972a3e463126577_748380_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=120 data-flex-basis=289px></p><p><strong>æ–‡æ¡£åŠ è½½å™¨çš„ä½œç”¨ï¼Œæ˜¯å°†ä¸åŒæ ¼å¼å’Œæ¥æºçš„æ•°æ®åŠ è½½åˆ°æ ‡å‡†çš„æ–‡æ¡£å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬å†…å®¹æœ¬èº«ä»¥åŠå…³è”çš„å…ƒæ•°æ®</strong>ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.01.35.png width=1538 height=1646 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.01.35_hu7ad7e39444b91dcc93dbdffa5607f287_871588_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.01.35_hu7ad7e39444b91dcc93dbdffa5607f287_871588_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=93 data-flex-basis=224px></p><p>LangChainæä¾›äº†å¤šç§ç±»å‹çš„æ–‡æ¡£åŠ è½½å™¨ï¼Œç”¨äºå¤„ç†éç»“æ„åŒ–æ•°æ®ï¼Œæ ¹æ®æ•°æ®æ¥æºçš„ä¸åŒå¤§è‡´å¯åˆ†ä¸ºï¼š</p><ul><li><p>å…¬å…±æ•°æ®æºåŠ è½½å™¨ï¼Œå¦‚YouTubeã€Twitterï¼›</p></li><li><p>ä¸“æœ‰æ•°æ®æºåŠ è½½å™¨ï¼Œå¦‚Figmaã€Notionã€‚</p></li></ul><p>æ–‡æ¡£åŠ è½½å™¨ä¹Ÿå¯ä»¥åŠ è½½ç»“æ„åŒ–æ•°æ®ï¼Œæ¯”å¦‚åŸºäºè¡¨æ ¼ä¸­åŒ…å«çš„æ–‡æœ¬æ•°æ®ï¼Œå¯¹é—®é¢˜è¿›è¡Œå›ç­”æˆ–è¯­ä¹‰æœç´¢ã€‚</p><p>è¿™ç§æŠ€æœ¯æˆ‘ä»¬ç§°ä¹‹ä¸ºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼ŒRetrieval-Augmented Generationï¼‰ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.12.02.png width=2936 height=826 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.12.02_hu8c292b7b52f1146895f28cac5e1cc60d_584276_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.12.02_hu8c292b7b52f1146895f28cac5e1cc60d_584276_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=355 data-flex-basis=853px></p><p><strong>åœ¨RAGä¸­ï¼ŒLLMä¼šä»å¤–éƒ¨æ•°æ®é›†ä¸­æ£€ç´¢ä¸Šä¸‹æ–‡æ–‡æ¡£ï¼Œä½œä¸ºå…¶æ‰§è¡Œçš„ä¸€éƒ¨åˆ†ï¼Œè¿™å¯¹äºè¯¢é—®ç‰¹å®šæ–‡æ¡£çš„é—®é¢˜éå¸¸æœ‰ç”¨</strong>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å®é™…ä½¿ç”¨å…¶ä¸­çš„ä¸€äº›æ–‡æ¡£åŠ è½½å™¨ã€‚</p><h2 id=åŠ è½½pdfæ–‡æ¡£>åŠ è½½PDFæ–‡æ¡£</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å¯¼å…¥PyPDFLoaderæ–‡æ¡£åŠ è½½å™¨</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>PyPDFLoader</span>
</span></span><span class=line><span class=cl><span class=c1># å°†ä½äºç‰¹å®šè·¯å¾„ä¸‹çš„PDFæ–‡æ¡£æ”¾å…¥åˆ°åŠ è½½å™¨ä¸­</span>
</span></span><span class=line><span class=cl><span class=n>loader</span> <span class=o>=</span> <span class=n>PyPDFLoader</span><span class=p>(</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># åŠ è½½PDFæ–‡æ¡£</span>
</span></span><span class=line><span class=cl><span class=n>pages</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™å°†åŠ è½½ä¸€ç³»åˆ—çš„æ–‡æ¡£ã€‚ä»¥é¡µé¢ä¸ºå•ä½ï¼Œæ¯ä¸ªé¡µé¢éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡æ¡£ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># PDFçš„æ€»é¡µæ•°</span>
</span></span><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=n>pages</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 22</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¯ä¸ªæ–‡æ¡£éƒ½åŒ…å«ã€Œé¡µé¢å†…å®¹ã€å’Œã€Œä¸æ–‡æ¡£å…³è”çš„å…ƒæ•°æ®ã€ã€‚</p><p>é¡µé¢å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># ä»…æ‰“å°å‰500ä¸ªå­—ç¬¦</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>page</span><span class=o>.</span><span class=n>page_content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>500</span><span class=p>])</span> 
</span></span></code></pre></td></tr></table></div></div><blockquote><p>MachineLearning-Lecture01<br>Instructor (Andrew Ng): Okay. Good morning. Welcome to CS229, the machine learning class. So what I wanna do today is ju st spend a little time going over the logistics of the class, and then we&rsquo;ll start to talk a bit about machine learning.<br>By way of introduction, my name&rsquo;s Andrew Ng and I&rsquo;ll be instru ctor for this class. And so I personally work in machine learning, and I&rsquo; ve worked on it for about 15 years now, and I actually think that machine learning i</p></blockquote><p>å…ƒæ•°æ®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>page</span><span class=o>.</span><span class=n>metadata</span>
</span></span><span class=line><span class=cl><span class=c1># source: æºä¿¡æ¯ï¼Œè¿™é‡Œå¯¹åº”PDFçš„æ–‡ä»¶å</span>
</span></span><span class=line><span class=cl><span class=c1># pageï¼šé¡µç ä¿¡æ¯ï¼Œè¿™é‡Œå¯¹åº”PDFçš„é¡µç </span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#39;, &#39;page&#39;: 0}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=åŠ è½½youtubeè§†é¢‘>åŠ è½½YouTubeè§†é¢‘</h2><h3 id=æ­¥éª¤1å¯¼å…¥å‡ ä¸ªå…³é”®éƒ¨åˆ†åŒ…æ‹¬>æ­¥éª¤1ï¼šå¯¼å…¥å‡ ä¸ªå…³é”®éƒ¨åˆ†ï¼ŒåŒ…æ‹¬</h3><ul><li><p>YouTubeéŸ³é¢‘åŠ è½½å™¨ï¼šä»YouTubeè§†é¢‘åŠ è½½éŸ³é¢‘æ–‡ä»¶</p></li><li><p>OpenAI Whisperè§£æå™¨ï¼šä½¿ç”¨OpenAIçš„Whisperæ¨¡å‹(ä¸€ä¸ªè¯­éŸ³è½¬æ–‡æœ¬çš„æ¨¡å‹)ï¼Œå°†YouTubeéŸ³é¢‘è½¬æ¢ä¸ºæˆ‘ä»¬å¯ä»¥å¤„ç†çš„æ–‡æœ¬æ ¼å¼</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders.generic</span> <span class=kn>import</span> <span class=n>GenericLoader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders.parsers</span> <span class=kn>import</span> <span class=n>OpenAIWhisperParser</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders.blob_loaders.youtube_audio</span> <span class=kn>import</span> <span class=n>YoutubeAudioLoader</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2æŒ‡å®šurlåŠä¿å­˜éŸ³é¢‘æ–‡ä»¶çš„ç›®å½•åˆ›å»ºç»„åˆäº†æ­¥éª¤1ä¸¤ä¸ªå…³é”®éƒ¨åˆ†çš„é€šç”¨åŠ è½½å™¨å¹¶æ‰§è¡ŒåŠ è½½>æ­¥éª¤2ï¼šæŒ‡å®šURLåŠä¿å­˜éŸ³é¢‘æ–‡ä»¶çš„ç›®å½•ï¼Œåˆ›å»ºç»„åˆäº†æ­¥éª¤1ä¸¤ä¸ªå…³é”®éƒ¨åˆ†çš„é€šç”¨åŠ è½½å™¨å¹¶æ‰§è¡ŒåŠ è½½</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;https://www.youtube.com/watch?v=jGwO_UgTS7I&#34;</span>
</span></span><span class=line><span class=cl><span class=n>save_dir</span><span class=o>=</span><span class=s2>&#34;docs/youtube/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>loader</span> <span class=o>=</span> <span class=n>GenericLoader</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>YoutubeAudioLoader</span><span class=p>([</span><span class=n>url</span><span class=p>],</span><span class=n>save_dir</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>OpenAIWhisperParser</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3æŸ¥çœ‹åŠ è½½å®Œæˆçš„è§†é¢‘æ–‡ç¨¿>æ­¥éª¤3ï¼šæŸ¥çœ‹åŠ è½½å®Œæˆçš„è§†é¢‘æ–‡ç¨¿</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>docs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>500</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=åŠ è½½ç½‘ç»œurl>åŠ è½½ç½‘ç»œURL</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>WebBaseLoader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>loader</span> <span class=o>=</span> <span class=n>WebBaseLoader</span><span class=p>(</span><span class=s2>&#34;https://github.com/basecamp/handbook/blob/master/37signals-is-you.md&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>docs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>[:</span><span class=mi>500</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ–‡æ¡£åˆ†å‰²>æ–‡æ¡£åˆ†å‰²</h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸åŒæ ¼å¼å’Œæ¥æºçš„æ•°æ®åŠ è½½åˆ°äº†æ ‡å‡†çš„æ–‡æ¡£å¯¹è±¡ä¸­ã€‚ä½†æ˜¯ï¼Œè¿™äº›æ–‡æ¡£ç»è¿‡è½¬æ¢åä¾ç„¶å¾ˆå¤§ï¼Œè€Œæˆ‘ä»¬é€šå¸¸åªéœ€è¦æ£€ç´¢æ–‡æ¡£ä¸­ä¸ä¸»é¢˜æœ€ç›¸å…³çš„å†…å®¹ï¼Œå¯èƒ½åªæ˜¯å‡ ä¸ªæ®µè½æˆ–å¥å­ï¼Œè€Œä¸éœ€è¦æ•´ä¸ªæ–‡æ¡£ã€‚</p><p>å› æ­¤ï¼Œåœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨LangChainçš„æ–‡æœ¬åˆ†å‰²å™¨ï¼ŒæŠŠå¤§å‹çš„æ–‡æ¡£åˆ†å‰²æˆæ›´å°çš„å—ã€‚</p><h2 id=æ–‡æ¡£åˆ†å‰²çš„é‡è¦æ€§>æ–‡æ¡£åˆ†å‰²çš„é‡è¦æ€§</h2><p><strong>æ–‡æ¡£åˆ†å‰²å‘ç”Ÿåœ¨æ•°æ®åŠ è½½ä¹‹åï¼Œæ”¾å…¥å‘é‡å­˜å‚¨ä¹‹å‰</strong>ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.15.14.png width=1508 height=1692 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.15.14_hu0c250fd91cced91b49ea0be419f1ff00_1161398_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.15.14_hu0c250fd91cced91b49ea0be419f1ff00_1161398_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=89 data-flex-basis=213px></p><p>å¦‚æœç®€å•åœ°æŒ‰å­—ç¬¦é•¿åº¦æ¥åˆ†å‰²æ–‡æ¡£ï¼Œå¯èƒ½ä¼šé€ æˆå¥å­çš„æ–­è£‚ï¼Œå¯¼è‡´è¯­ä¹‰çš„ä¸¢å¤±æˆ–æ··ä¹±ã€‚è¿™æ ·çš„åˆ†å‰²æ–¹å¼ï¼Œæ— æ³•ä¸ºæˆ‘ä»¬æ­£ç¡®åœ°å›ç­”é—®é¢˜ã€‚</p><p>åˆç†çš„åšæ³•ï¼Œæ˜¯å°½é‡ä¿æŒè¯­ä¹‰çš„è¿è´¯æ€§å’Œå®Œæ•´æ€§ï¼Œåˆ†éš”å‡ºæœ‰æ„ä¹‰çš„å—ã€‚</p><h2 id=æ–‡æ¡£åˆ†å‰²çš„æ–¹å¼>æ–‡æ¡£åˆ†å‰²çš„æ–¹å¼</h2><p>åœ¨LangChainä¸­ï¼Œæ‰€æœ‰çš„æ–‡æœ¬åˆ†å‰²å™¨éƒ½éµå¾ªåŒä¸€ä¸ªåŸç†ï¼Œå°±æ˜¯æ ¹æ®ã€Œå—å¤§å°(chunk_size)ã€å’Œã€Œä¸¤ä¸ªå—ä¹‹é—´çš„é‡å å¤§å°(chunk_overlap)ã€è¿›è¡Œåˆ†å‰²ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.17.41.png width=1612 height=1696 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.17.41_hu67bc95fe5e6d5e1ab5693fdde72bd774_868866_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.17.41_hu67bc95fe5e6d5e1ab5693fdde72bd774_868866_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=95 data-flex-basis=228px></p><p><code>chunk_size</code>æŒ‡çš„æ˜¯æ¯ä¸ªå—åŒ…å«çš„å­—ç¬¦æˆ–Tokenï¼ˆå¦‚å•è¯ã€å¥å­ç­‰ï¼‰çš„æ•°é‡ã€‚</p><p><code>chunk_overlap</code>æŒ‡çš„æ˜¯ä¸¤ä¸ªå—ä¹‹é—´å…±äº«çš„å­—ç¬¦æˆ–Tokençš„æ•°é‡ã€‚chunk_overlapå¯ä»¥å¸®åŠ©ä¿æŒä¸Šä¸‹æ–‡çš„è¿è´¯æ€§ï¼Œé¿å…å› ä¸ºåˆ†å‰²è€Œä¸¢å¤±é‡è¦çš„ä¿¡æ¯ã€‚</p><p>LangChainæä¾›äº†å¤šç§ç±»å‹çš„åˆ†å‰²å™¨ï¼Œä¸»è¦å·®åˆ«åœ¨äºå¦‚ä½•ç¡®å®šå—çš„è¾¹ç•Œã€å—ç”±å“ªäº›å­—ç¬¦æˆ–Tokenç»„æˆã€ä»¥åŠå¦‚ä½•æµ‹é‡å—çš„å¤§å°ï¼ˆæŒ‰å­—ç¬¦è¿˜æ˜¯æŒ‰Tokenï¼‰ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.19.02.png width=1360 height=1292 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.19.02_hu9a6fdaf0aca0515884a89ff0a75a7896_763219_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.19.02_hu9a6fdaf0aca0515884a89ff0a75a7896_763219_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=105 data-flex-basis=252px></p><p>å…ƒæ•°æ®ï¼ˆMetadataï¼‰æ˜¯å—åˆ†å‰²çš„å¦ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ‰€æœ‰å—ä¸­ä¿æŒå…ƒæ•°æ®çš„ä¸€è‡´æ€§ï¼ŒåŒæ—¶åœ¨éœ€è¦çš„æ—¶å€™æ·»åŠ æ–°çš„å…ƒæ•°æ®ã€‚</p><h2 id=åŸºäºå­—ç¬¦çš„åˆ†å‰²>åŸºäºå­—ç¬¦çš„åˆ†å‰²</h2><p>å¦‚ä½•åˆ†å‰²å—é€šå¸¸å–å†³äºæˆ‘ä»¬æ­£åœ¨å¤„ç†çš„æ–‡æ¡£ç±»å‹ã€‚</p><p>æ¯”å¦‚ï¼Œå¤„ç†ä»£ç çš„åˆ†å‰²å™¨æ‹¥æœ‰è®¸å¤šä¸åŒç¼–ç¨‹è¯­è¨€çš„åˆ†éš”ç¬¦ï¼Œå¦‚Pythonã€Rubyã€Cç­‰ã€‚å½“åˆ†å‰²ä»£ç æ–‡æ¡£æ—¶ï¼Œå®ƒä¼šè€ƒè™‘åˆ°ä¸åŒç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„å·®å¼‚ã€‚</p><h3 id=æ­¥éª¤1å¯¼å…¥æ–‡æœ¬åˆ†å‰²å™¨>æ­¥éª¤1ï¼šå¯¼å…¥æ–‡æœ¬åˆ†å‰²å™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># RecursiveCharacterTextSplitter-é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</span>
</span></span><span class=line><span class=cl><span class=c1># CharacterTextSplitter-å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>,</span> <span class=n>CharacterTextSplitter</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2è®¾å®šå—å¤§å°å’Œå—é‡å å¤§å°>æ­¥éª¤2ï¼šè®¾å®šå—å¤§å°å’Œå—é‡å å¤§å°</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>chunk_size</span> <span class=o>=</span><span class=mi>26</span>
</span></span><span class=line><span class=cl><span class=n>chunk_overlap</span> <span class=o>=</span> <span class=mi>4</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3åˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨>æ­¥éª¤3ï¼šåˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>r_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span><span class=o>=</span><span class=n>chunk_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span><span class=o>=</span><span class=n>chunk_overlap</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c_splitter</span> <span class=o>=</span> <span class=n>CharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span><span class=o>=</span><span class=n>chunk_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span><span class=o>=</span><span class=n>chunk_overlap</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤4ä½¿ç”¨ä¸åŒçš„åˆ†å‰²å™¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²>æ­¥éª¤4ï¼šä½¿ç”¨ä¸åŒçš„åˆ†å‰²å™¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²</h3><h4 id=é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨>é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>text2</span> <span class=o>=</span> <span class=s1>&#39;abcdefghijklmnopqrstuvwxyzabcdefg&#39;</span>
</span></span><span class=line><span class=cl><span class=n>r_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>text2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;abcdefghijklmnopqrstuvwxyz&#39;, &#39;wxyzabcdefg&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒä¸ªå—æ˜¯ä»ã€Œwxyzã€å¼€å§‹çš„ï¼Œåˆšå¥½æ˜¯æˆ‘ä»¬è®¾å®šçš„å—é‡å å¤§å°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>text3</span> <span class=o>=</span> <span class=s2>&#34;a b c d e f g h i j k l m n o p q r s t u v w x y z&#34;</span>
</span></span><span class=line><span class=cl><span class=n>r_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>text3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;a b c d e f g h i j k l m&#39;, &#39;l m n o p q r s t u v w x&#39;, &#39;w x y z&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨>å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>text3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;a b c d e f g h i j k l m n o p q r s t u v w x y z&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨å®é™…å¹¶æ²¡æœ‰åˆ†å‰²è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ˜¯å› ä¸ºå­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨é»˜è®¤æ˜¯ä»¥æ¢è¡Œç¬¦ä¸ºåˆ†éš”ç¬¦çš„ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†åˆ†éš”ç¬¦è®¾ç½®ä¸ºç©ºæ ¼ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c_splitter</span> <span class=o>=</span> <span class=n>CharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span><span class=o>=</span><span class=n>chunk_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span><span class=o>=</span><span class=n>chunk_overlap</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>separator</span> <span class=o>=</span> <span class=s1>&#39; &#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>text3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [&#39;a b c d e f g h i j k l m&#39;, &#39;l m n o p q r s t u v w x&#39;, &#39;w x y z&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤5é€’å½’åˆ†å‰²é•¿æ®µè½>æ­¥éª¤5ï¼šé€’å½’åˆ†å‰²é•¿æ®µè½</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>some_text</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;When writing documents, writers will use document structure to group content. </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>This can convey to the reader, which idea&#39;s are related. For example, closely related ideas </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>are in sentances. Similar ideas are in paragraphs. Paragraphs form a document. </span><span class=se>\n\n</span><span class=s2>  </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Paragraphs are often delimited with a carriage return or two carriage returns. </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Carriage returns are the &#34;backslash n&#34; you see embedded in this string. </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Sentences have a period at the end, but also, have a space.</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>and words are separated by space.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>r_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span><span class=o>=</span><span class=mi>150</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>separators</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>some_text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªåˆ†éš”ç¬¦åˆ—è¡¨ï¼Œä¾æ¬¡ä¸ºåŒæ¢è¡Œç¬¦ã€å•æ¢è¡Œç¬¦ã€ç©ºæ ¼å’Œä¸€ä¸ªç©ºå­—ç¬¦ã€‚</p><p>è¿™å°±æ„å‘³ç€ï¼Œå½“ä½ åˆ†å‰²ä¸€æ®µæ–‡æœ¬æ—¶ï¼Œå®ƒä¼šé¦–å…ˆé‡‡ç”¨åŒæ¢è¡Œç¬¦æ¥å°è¯•åˆæ­¥åˆ†å‰²ï¼Œå¹¶è§†æƒ…å†µä¾æ¬¡ä½¿ç”¨å…¶ä»–çš„åˆ†éš”ç¬¦æ¥è¿›ä¸€æ­¥åˆ†å‰²ã€‚</p><p>æœ€ç»ˆåˆ†å‰²ç»“æœå¦‚ä¸‹ï¼š</p><blockquote><p>[&ldquo;When writing documents, writers will use document structure to group content. This can convey to the reader, which idea&rsquo;s are related. For example, closely related ideas are in sentances. Similar ideas are in paragraphs. Paragraphs form a document.&rdquo;,</p><p>&lsquo;Paragraphs are often delimited with a carriage return or two carriage returns. Carriage returns are the &ldquo;backslash n&rdquo; you see embedded in this string. Sentences have a period at the end, but also, have a space.and words are separated by space.&rsquo;]</p></blockquote><p>å¦‚æœéœ€è¦æŒ‰ç…§å¥å­è¿›è¡Œåˆ†éš”ï¼Œåˆ™è¿˜è¦ç”¨æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ ä¸€ä¸ªå¥å·åˆ†éš”ç¬¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>r_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span><span class=o>=</span><span class=mi>150</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>separators</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;(?&lt;=\. )&#34;</span><span class=p>,</span> <span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>some_text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>[&ldquo;When writing documents, writers will use document structure to group content. This can convey to the reader, which idea&rsquo;s are related.&rdquo;,</p><p>&lsquo;For example, closely related ideas are in sentances. Similar ideas are in paragraphs. Paragraphs form a document.&rsquo;,</p><p>&lsquo;Paragraphs are often delimited with a carriage return or two carriage returns.&rsquo;,</p><p>&lsquo;Carriage returns are the &ldquo;backslash n&rdquo; you see embedded in this string.&rsquo;,</p><p>&lsquo;Sentences have a period at the end, but also, have a space.and words are separated by space.&rsquo;]</p></blockquote><p>è¿™å°±æ˜¯é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨åå­—ä¸­â€œé€’å½’â€çš„å«ä¹‰ï¼Œæ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬æ›´å»ºè®®åœ¨é€šç”¨æ–‡æœ¬ä¸­ä½¿ç”¨é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨ã€‚</p><h2 id=åŸºäºtokençš„åˆ†å‰²>åŸºäºTokençš„åˆ†å‰²</h2><p>å¾ˆå¤šLLMçš„ä¸Šä¸‹æ–‡çª—å£é•¿åº¦é™åˆ¶æ˜¯æŒ‰ç…§Tokenæ¥è®¡æ•°çš„ã€‚å› æ­¤ï¼Œä»¥LLMçš„è§†è§’ï¼ŒæŒ‰ç…§Tokenå¯¹æ–‡æœ¬è¿›è¡Œåˆ†éš”ï¼Œé€šå¸¸å¯ä»¥å¾—åˆ°æ›´å¥½çš„ç»“æœã€‚</p><p>ä¸ºäº†ç†è§£åŸºäºå­—ç¬¦åˆ†å‰²å’ŒåŸºäºTokenåˆ†å‰²çš„åŒºåˆ«ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>TokenTextSplitter</span>
</span></span><span class=line><span class=cl><span class=n>text_splitter</span> <span class=o>=</span> <span class=n>TokenTextSplitter</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>text1</span> <span class=o>=</span> <span class=s2>&#34;foo bar bazzyfoo&#34;</span>
</span></span><span class=line><span class=cl><span class=n>text_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>text1</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªTokenæ–‡æœ¬åˆ†å‰²å™¨ï¼Œå°†å—å¤§å°è®¾ä¸º1ï¼Œå—é‡å å¤§å°è®¾ä¸º0ï¼Œç›¸å½“äºå°†ä»»æ„å­—ç¬¦ä¸²åˆ†å‰²æˆäº†å•ä¸ªTokenç»„æˆçš„åˆ—è¡¨ï¼Œæ¯ä¸ªTokençš„å†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;foo&#39;</span><span class=p>,</span> <span class=s1>&#39; bar&#39;</span><span class=p>,</span> <span class=s1>&#39; b&#39;</span><span class=p>,</span> <span class=s1>&#39;az&#39;</span><span class=p>,</span> <span class=s1>&#39;zy&#39;</span><span class=p>,</span> <span class=s1>&#39;foo&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤ï¼ŒTokençš„é•¿åº¦å’Œå­—ç¬¦é•¿åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼ŒTokené€šå¸¸ä¸º4ä¸ªå­—ç¬¦ã€‚</p><h2 id=åˆ†å‰²markdownæ–‡æ¡£>åˆ†å‰²Markdownæ–‡æ¡£</h2><p><strong>åˆ†å—çš„ç›®çš„æ—¨åœ¨å°†å…·æœ‰å…±åŒä¸Šä¸‹æ–‡çš„æ–‡æœ¬æ”¾åœ¨ä¸€èµ·</strong>ã€‚</p><p>é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨æŒ‡å®šåˆ†éš”ç¬¦æ¥è¿›è¡Œåˆ†éš”ï¼Œä½†æœ‰äº›ç±»å‹çš„æ–‡æ¡£ï¼ˆä¾‹å¦‚ Markdownï¼‰æœ¬èº«å°±å…·æœ‰å¯ç”¨äºåˆ†å‰²çš„ç»“æ„ï¼ˆå¦‚æ ‡é¢˜ï¼‰ã€‚</p><p>Markdownæ ‡é¢˜æ–‡æœ¬åˆ†å‰²å™¨ä¼šæ ¹æ®æ ‡é¢˜æˆ–å­æ ‡é¢˜æ¥åˆ†å‰²ä¸€ä¸ªMarkdownæ–‡æ¡£ï¼Œå¹¶å°†æ ‡é¢˜ä½œä¸ºå…ƒæ•°æ®æ·»åŠ åˆ°æ¯ä¸ªå—ä¸­ã€‚</p><h3 id=æ­¥éª¤1å®šä¹‰ä¸€ä¸ªmarkdownæ–‡æ¡£>æ­¥éª¤1ï¼šå®šä¹‰ä¸€ä¸ªMarkdownæ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>NotionDirectoryLoader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>MarkdownHeaderTextSplitter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>markdown_document</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;# Title</span><span class=se>\n\n</span><span class=s2> </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>## Chapter 1</span><span class=se>\n\n</span><span class=s2> </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Hi this is Jim</span><span class=se>\n\n</span><span class=s2> Hi this is Joe</span><span class=se>\n\n</span><span class=s2> </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>### Section </span><span class=se>\n\n</span><span class=s2> </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Hi this is Lance </span><span class=se>\n\n</span><span class=s2> 
</span></span></span><span class=line><span class=cl><span class=s2>## Chapter 2</span><span class=se>\n\n</span><span class=s2> </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>Hi this is Molly&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2å®šä¹‰æƒ³è¦åˆ†å‰²çš„æ ‡é¢˜åˆ—è¡¨å’Œåç§°>æ­¥éª¤2ï¼šå®šä¹‰æƒ³è¦åˆ†å‰²çš„æ ‡é¢˜åˆ—è¡¨å’Œåç§°</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>headers_to_split_on</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;#&#34;</span><span class=p>,</span> <span class=s2>&#34;Header 1&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;##&#34;</span><span class=p>,</span> <span class=s2>&#34;Header 2&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;###&#34;</span><span class=p>,</span> <span class=s2>&#34;Header 3&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3åˆå§‹åŒ–markdownæ ‡é¢˜æ–‡æœ¬åˆ‡åˆ†å™¨åˆ†å‰²markdownæ–‡æ¡£>æ­¥éª¤3ï¼šåˆå§‹åŒ–Markdownæ ‡é¢˜æ–‡æœ¬åˆ‡åˆ†å™¨ï¼Œåˆ†å‰²Markdownæ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>markdown_splitter</span> <span class=o>=</span> <span class=n>MarkdownHeaderTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>headers_to_split_on</span><span class=o>=</span><span class=n>headers_to_split_on</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>md_header_splits</span> <span class=o>=</span> <span class=n>markdown_splitter</span><span class=o>.</span><span class=n>split_text</span><span class=p>(</span><span class=n>markdown_document</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>md_header_splits</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># Document(page_content=&#39;Hi this is Jim  \nHi this is Joe&#39;, metadata={&#39;Header 1&#39;: &#39;Title&#39;, &#39;Header 2&#39;: &#39;Chapter 1&#39;})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>md_header_splits</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># Document(page_content=&#39;Hi this is Lance&#39;, metadata={&#39;Header 1&#39;: &#39;Title&#39;, &#39;Header 2&#39;: &#39;Chapter 1&#39;, &#39;Header 3&#39;: &#39;Section&#39;})</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªå—éƒ½åŒ…å«äº†é¡µé¢å†…å®¹å’Œå…ƒæ•°æ®ï¼Œå…ƒæ•°æ®ä¸­è®°å½•äº†è¯¥å—æ‰€å±çš„æ ‡é¢˜å’Œå­æ ‡é¢˜ã€‚</p><p>æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•å°†é•¿æ–‡æ¡£åˆ†å‰²ä¸ºè¯­ä¹‰ç›¸å…³çš„å—ï¼Œå¹¶ä¸”åŒ…å«æ­£ç¡®çš„å…ƒæ•°æ®ã€‚æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯å°†è¿™äº›å—æ”¾å…¥åˆ°ä¸€ä¸ªç´¢å¼•ä¸­ï¼Œè¿™æ ·å½“æˆ‘ä»¬è¦å›ç­”æŸä¸ªæ•°æ®é›†ç›¸å…³çš„é—®é¢˜æ—¶ï¼Œå°±èƒ½è½»æ¾åœ°æ£€ç´¢åˆ°å¯¹åº”çš„å—ã€‚</p><p>è¦å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸¤ä¸ªæŠ€æœ¯ï¼šåµŒå…¥(Embedding)å’Œå‘é‡å­˜å‚¨(Vector Store) ã€‚</p><h2 id=å‘é‡å­˜å‚¨å’ŒåµŒå…¥>å‘é‡å­˜å‚¨å’ŒåµŒå…¥</h2><p>åµŒå…¥æ˜¯å°†ä¸€æ®µæ–‡æœ¬è½¬åŒ–ä¸ºæ•°å€¼å½¢å¼ã€‚<strong>å…·æœ‰ç›¸ä¼¼å†…å®¹çš„æ–‡æœ¬åœ¨æ•°å€¼ç©ºé—´ä¸­ä¼šæœ‰ç›¸ä¼¼çš„å‘é‡</strong>ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¯”è¾ƒè¿™äº›å‘é‡ï¼Œæ¥æ‰¾å‡ºç›¸ä¼¼çš„æ–‡æœ¬ç‰‡æ®µã€‚</p><p>è€Œå‘é‡å­˜å‚¨æ˜¯ä¸€ç§æ•°æ®åº“ï¼Œå®ƒç”¨æ¥å­˜å‚¨åˆ†å‰²åçš„æ–‡æ¡£ç‰‡æ®µä»¥åŠå®ƒä»¬å¯¹åº”çš„åµŒå…¥ï¼Œæ–¹ä¾¿æˆ‘ä»¬åç»­æ ¹æ®é—®é¢˜æŸ¥æ‰¾ç›¸å…³çš„æ–‡æ¡£ã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œå¹¶ä¸ºå®ƒç”Ÿæˆä¸€ä¸ªåµŒå…¥ï¼›</li><li>å°†å®ƒè·Ÿå‘é‡å­˜å‚¨é‡Œçš„æ‰€æœ‰ä¸åŒçš„å‘é‡è¿›è¡Œæ¯”è¾ƒï¼›</li><li>é€‰å‡ºæœ€ç›¸ä¼¼çš„å‰nä¸ªç‰‡æ®µï¼›</li><li>å°†é€‰å‡ºçš„ç‰‡æ®µå’Œé—®é¢˜ä¸€èµ·è¾“å…¥åˆ°LLMé‡Œï¼Œå¾—åˆ°ä¸€ä¸ªç­”æ¡ˆã€‚</li></ol><p>ä¸ºäº†å¸®åŠ©ç†è§£ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><h3 id=æ­¥éª¤1æä¾›ä¸€äº›ä¾‹å¥å…¶ä¸­å‰ä¸¤å¥éå¸¸ç›¸ä¼¼ç¬¬ä¸‰å¥åˆ™ä¸å‰ä¸¤å¥å…³è”ä¸å¤§>æ­¥éª¤1ï¼šæä¾›ä¸€äº›ä¾‹å¥ï¼Œå…¶ä¸­å‰ä¸¤å¥éå¸¸ç›¸ä¼¼ï¼Œç¬¬ä¸‰å¥åˆ™ä¸å‰ä¸¤å¥å…³è”ä¸å¤§</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>sentence1</span> <span class=o>=</span> <span class=s2>&#34;i like dogs&#34;</span>
</span></span><span class=line><span class=cl><span class=n>sentence2</span> <span class=o>=</span> <span class=s2>&#34;i like canines&#34;</span>
</span></span><span class=line><span class=cl><span class=n>sentence3</span> <span class=o>=</span> <span class=s2>&#34;the weather is ugly outside&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2ä½¿ç”¨embbedingç±»ä¸ºæ¯ä¸ªå¥å­ç”Ÿæˆä¸€ä¸ªåµŒå…¥>æ­¥éª¤2ï¼šä½¿ç”¨Embbedingç±»ä¸ºæ¯ä¸ªå¥å­ç”Ÿæˆä¸€ä¸ªåµŒå…¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.embeddings.openai</span> <span class=kn>import</span> <span class=n>OpenAIEmbeddings</span>
</span></span><span class=line><span class=cl><span class=n>embedding</span> <span class=o>=</span> <span class=n>OpenAIEmbeddings</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>embedding1</span> <span class=o>=</span> <span class=n>embedding</span><span class=o>.</span><span class=n>embed_query</span><span class=p>(</span><span class=n>sentence1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>embedding2</span> <span class=o>=</span> <span class=n>embedding</span><span class=o>.</span><span class=n>embed_query</span><span class=p>(</span><span class=n>sentence2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>embedding3</span> <span class=o>=</span> <span class=n>embedding</span><span class=o>.</span><span class=n>embed_query</span><span class=p>(</span><span class=n>sentence3</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3ç”¨ç‚¹ç§¯dot-productæ¥è®¡ç®—ä¸¤ä¸¤ä¹‹é—´çš„åµŒå…¥ç›¸ä¼¼åº¦>æ­¥éª¤3ï¼šç”¨ç‚¹ç§¯(dot product)æ¥è®¡ç®—ä¸¤ä¸¤ä¹‹é—´çš„åµŒå…¥ç›¸ä¼¼åº¦</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>embedding1</span><span class=p>,</span> <span class=n>embedding2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 0.9631853877103518</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>embedding1</span><span class=p>,</span> <span class=n>embedding3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 0.7709997651294672</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>embedding2</span><span class=p>,</span> <span class=n>embedding3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 0.7596334120325523</span>
</span></span></code></pre></td></tr></table></div></div><p>ç‚¹ç§¯çš„å€¼è¶Šå¤§ï¼Œä»£è¡¨ç›¸ä¼¼åº¦å°±è¶Šé«˜ã€‚</p><p>å†æ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼š</p><p>ç›®æ ‡æ˜¯ä¸ºæä¾›çš„æ‰€æœ‰PDFæ–‡æ¡£ç”ŸæˆåµŒå…¥ï¼Œå¹¶æŠŠå®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªå‘é‡å­˜å‚¨é‡Œã€‚</p><h3 id=æ­¥éª¤1åŠ è½½pdfæ–‡æ¡£>æ­¥éª¤1ï¼šåŠ è½½PDFæ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>PyPDFLoader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åŠ è½½ PDF</span>
</span></span><span class=line><span class=cl><span class=n>loaders</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c1># é‡å¤åŠ è½½ç¬¬ä¸€ä¸ªæ–‡æ¡£ï¼Œæ¨¡æ‹Ÿä¸€äº›è„æ•°æ®</span>
</span></span><span class=line><span class=cl>    <span class=n>PyPDFLoader</span><span class=p>(</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>PyPDFLoader</span><span class=p>(</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>PyPDFLoader</span><span class=p>(</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture02.pdf&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>PyPDFLoader</span><span class=p>(</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>loader</span> <span class=ow>in</span> <span class=n>loaders</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>docs</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2ç”¨é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨æ¥æŠŠæ–‡æ¡£åˆ†æˆå—>æ­¥éª¤2ï¼šç”¨é€’å½’å­—ç¬¦æ–‡æœ¬åˆ†å‰²å™¨æ¥æŠŠæ–‡æ¡£åˆ†æˆå—</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># åˆ†å‰²</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>RecursiveCharacterTextSplitter</span>
</span></span><span class=line><span class=cl><span class=n>text_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_size</span> <span class=o>=</span> <span class=mi>1500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chunk_overlap</span> <span class=o>=</span> <span class=mi>150</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>splits</span> <span class=o>=</span> <span class=n>text_splitter</span><span class=o>.</span><span class=n>split_documents</span><span class=p>(</span><span class=n>docs</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3ä¸ºæ¯ä¸ªå—ç”ŸæˆåµŒå…¥å¹¶åˆ›å»ºchromaå‘é‡å­˜å‚¨>æ­¥éª¤3ï¼šä¸ºæ¯ä¸ªå—ç”ŸæˆåµŒå…¥ï¼Œå¹¶åˆ›å»ºChromaå‘é‡å­˜å‚¨</h3><p>è¿™é‡Œç”¨åˆ°çš„å‘é‡å­˜å‚¨æ˜¯Chromaã€‚Chromaæ˜¯ä¸€ç§è½»é‡çº§ã€åŸºäºå†…å­˜çš„å‘é‡å­˜å‚¨ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯å…ˆç”¨[rm -rf ./docs/chroma]ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§æ•°æ®åº“æ•°æ®</span>
</span></span><span class=line><span class=cl><span class=n>persist_directory</span> <span class=o>=</span> <span class=s1>&#39;docs/chroma/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¼ å…¥ä¹‹å‰åˆ›å»ºçš„åˆ†å‰²å’ŒåµŒå…¥ï¼Œä»¥åŠæŒä¹…åŒ–ç›®å½•</span>
</span></span><span class=line><span class=cl><span class=n>vectordb</span> <span class=o>=</span> <span class=n>Chroma</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>documents</span><span class=o>=</span><span class=n>splits</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>embedding</span><span class=o>=</span><span class=n>embedding</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>persist_directory</span><span class=o>=</span><span class=n>persist_directory</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤4ç”¨ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•æ¥æŸ¥æ‰¾æ–‡æ¡£>æ­¥éª¤4ï¼šç”¨ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•æ¥æŸ¥æ‰¾æ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;is there an email i can ask for help&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># K=3ç”¨äºæŒ‡å®šè¿”å›çš„æ–‡æ¡£æ•°é‡</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>vectordb</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span><span class=n>k</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥æ‰“å°æ–‡æ¡£çš„é•¿åº¦å’Œå†…å®¹æ¥æ£€æŸ¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>len</span><span class=p>(</span><span class=n>docs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤5æŒä¹…åŒ–å‘é‡æ•°æ®åº“ä»¥ä¾¿ä»¥åä½¿ç”¨>æ­¥éª¤5ï¼šæŒä¹…åŒ–å‘é‡æ•°æ®åº“ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>vectordb</span><span class=o>.</span><span class=n>persist</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†è®¨è®ºä¸€äº›è¾¹ç¼˜æ¡ˆä¾‹ï¼Œå±•ç¤ºå‡ ç§å¯èƒ½å‡ºç°å¤±è´¥æƒ…å†µï¼š</p><h3 id=å¤±è´¥æƒ…å†µ1é‡å¤çš„å—å¯¼è‡´é‡å¤çš„å†—ä½™ä¿¡æ¯>å¤±è´¥æƒ…å†µ1ï¼šé‡å¤çš„å—å¯¼è‡´é‡å¤çš„å†—ä½™ä¿¡æ¯</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about matlab?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>vectordb</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span><span class=n>k</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>docs</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­ï¼Œdocs[0] å’Œ docs[1] å¾—åˆ°çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±æœ‰æ„é‡å¤åŠ è½½äº†ç¬¬ä¸€ä¸ªæ–‡æ¡£ã€‚</p><p>è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œæˆ‘ä»¬æŠŠä¸¤ä¸ªå†…å®¹ç›¸åŒçš„åˆ†å—éƒ½ä¼ ç»™äº†è¯­è¨€æ¨¡å‹ã€‚è€Œç¬¬äºŒä¸ªåˆ†å—æ˜¯æ²¡æœ‰ä»·å€¼çš„ï¼Œå¦‚æœæ¢æˆä¸€ä¸ªå†…å®¹ä¸åŒçš„åˆ†å—ä¼šæ›´å¥½ï¼Œè¿™æ ·è‡³å°‘è¯­è¨€æ¨¡å‹å¯ä»¥ä»ä¸­è·å–æ›´å¤šä¿¡æ¯ã€‚</p><p>åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åœ¨ä¿è¯æ£€ç´¢åˆ°ç›¸å…³çš„å—çš„åŒæ—¶ï¼Œä¹Ÿèƒ½ä¿è¯æ¯ä¸ªå—éƒ½æ˜¯å”¯ä¸€çš„ã€‚</p><h3 id=å¤±è´¥æƒ…å†µ2æ— æ³•å®Œæ•´æ•æ‰åˆ°é—®é¢˜ä¸­çš„å…³é”®ä¿¡æ¯>å¤±è´¥æƒ…å†µ2ï¼šæ— æ³•å®Œæ•´æ•æ‰åˆ°é—®é¢˜ä¸­çš„å…³é”®ä¿¡æ¯</h3><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼Œâ€œç¬¬ä¸‰å ‚è¯¾é‡Œä»–ä»¬è®²äº†ä»€ä¹ˆå…³äºå›å½’çš„å†…å®¹ï¼Ÿâ€</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about regression in the third lecture?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>vectordb</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span><span class=n>k</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½çœ‹å‡ºï¼Œé—®é¢˜çš„æé—®è€…æ˜¯æƒ³è¦ä»ç¬¬ä¸‰å ‚è¯¾é‡Œæ‰¾åˆ°ç­”æ¡ˆçš„ã€‚</p><p>ä½†å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬éå†æ‰€æœ‰æ–‡æ¡£ï¼Œå¹¶æ‰“å°å‡ºå…ƒæ•°æ®åä¼šå‘ç°ï¼Œç»“æœé‡Œå®é™…ä¸Šæ··åˆäº†å¤šä¸ªæ–‡æ¡£çš„å†…å®¹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=n>docs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>doc</span><span class=o>.</span><span class=n>metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 0}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 14}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture02.pdf&#39;, &#39;page&#39;: 0}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 6}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#39;, &#39;page&#39;: 8}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬åªæ˜¯åŸºäºåµŒå…¥åšäº†ä¸€ä¸ªè¯­ä¹‰æœç´¢ï¼Œå®ƒä¸ºæ•´ä¸ªå¥å­ç”Ÿæˆäº†ä¸€ä¸ªåµŒå…¥ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæ›´å…³æ³¨äºâ€œå›å½’â€è¿™ä¸ªè¯ã€‚</p><p>å½“æˆ‘ä»¬æŸ¥çœ‹ç¬¬äº”ä¸ªæ–‡æ¡£æ—¶ï¼Œå°±ä¼šå‘ç°å®ƒç¡®å®æåˆ°äº†â€œå›å½’â€è¿™ä¸ªè¯ã€‚</p><h3 id=å¤±è´¥æƒ…å†µ3éšç€æ£€ç´¢æ–‡æ¡£æ•°é‡çš„å¢åŠ ç›¸å…³æ€§é€æ¸é™ä½>å¤±è´¥æƒ…å†µ3ï¼šéšç€æ£€ç´¢æ–‡æ¡£æ•°é‡çš„å¢åŠ ï¼Œç›¸å…³æ€§é€æ¸é™ä½</h3><p>å½“æˆ‘ä»¬å°è¯•æ”¹å˜kå€¼ï¼Œä¹Ÿå°±æ˜¯æ£€ç´¢çš„æ–‡æ¡£æ•°é‡æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°æ›´å¤šçš„æ–‡æ¡£ï¼Œä½†ç»“æœåˆ—è¡¨åé¢çš„æ–‡æ¡£å¯èƒ½æ²¡æœ‰å‰é¢çš„é‚£äº›ç›¸å…³æ€§å¼ºã€‚</p><h2 id=æ£€ç´¢>æ£€ç´¢</h2><p>åœ¨è¿™ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ã€Œæ£€ç´¢ã€æŠ€æœ¯ï¼Œå¹¶ä»‹ç»ä¸€äº›æ›´å…ˆè¿›çš„æ–¹æ³•æ¥å…‹æœä¸Šä¸€è¯¾çš„è¾¹ç¼˜æƒ…å†µã€‚</p><p><strong>æ£€ç´¢æ˜¯æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æµç¨‹çš„æ ¸å¿ƒ</strong>ã€‚</p><h2 id=è§£å†³å¤šæ ·æ€§æœ€å¤§è¾¹ç¼˜ç›¸å…³æ€§>è§£å†³å¤šæ ·æ€§ï¼šæœ€å¤§è¾¹ç¼˜ç›¸å…³æ€§</h2><p>æœ€å¤§è¾¹ç¼˜ç›¸å…³æ€§(MMR, Maximum Marginal Relevance)èƒŒåçš„ç†å¿µæ˜¯ï¼Œ<strong>å¦‚æœæˆ‘ä»¬æ€»æ˜¯é€‰æ‹©ä¸æŸ¥è¯¢åœ¨åµŒå…¥ç©ºé—´ä¸­æœ€ç›¸ä¼¼çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé”™è¿‡ä¸€äº›å¤šå…ƒåŒ–çš„ä¿¡æ¯</strong>ã€‚</p><p>MMRå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªæ›´å¤šæ ·åŒ–çš„æ–‡æ¡£é›†åˆã€‚</p><p><strong>MMRåœ¨ä¿æŒæŸ¥è¯¢ç›¸å…³æ€§çš„åŒæ—¶ï¼Œå°½é‡å¢åŠ ç»“æœä¹‹é—´çš„å¤šæ ·æ€§</strong>ï¼Œå®ƒçš„åšæ³•æ˜¯ï¼š</p><ol><li>é¦–å…ˆå‘é€ä¸€ä¸ªæŸ¥è¯¢ï¼Œå¾—åˆ°ä¸€ç»„å›ç­”ï¼›</li><li>ç”¨"fetch_k"å‚æ•°æŒ‡å®šæˆ‘ä»¬æƒ³è¦è·å–çš„å“åº”æ•°é‡ï¼Œè¿™å®Œå…¨åŸºäºè¯­ä¹‰ç›¸ä¼¼æ€§ï¼›</li><li>ç„¶åï¼Œé’ˆå¯¹è¿™ä¸ªè¾ƒå°çš„æ–‡æ¡£é›†åˆï¼Œä»å¤šæ ·æ€§æ–¹é¢è¿›è¡Œä¼˜åŒ–ï¼›</li><li>æœ€åä»è¿™ç»„æ–‡æ¡£ä¸­ï¼Œé€‰æ‹©"k"ä¸ªå“åº”è¿”å›ç»™ç”¨æˆ·ã€‚</li></ol><p>æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å¸®åŠ©ç†è§£ï¼š</p><p>ç›®æ ‡æ˜¯æŸ¥è¯¢æœ‰æŒ‡å®šç‰¹å¾çš„è˜‘è‡ä¿¡æ¯ã€‚</p><h3 id=æ­¥éª¤1åˆ›å»ºchromaå‘é‡å­˜å‚¨>æ­¥éª¤1ï¼šåˆ›å»ºChromaå‘é‡å­˜å‚¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.embeddings.openai</span> <span class=kn>import</span> <span class=n>OpenAIEmbeddings</span>
</span></span><span class=line><span class=cl><span class=n>persist_directory</span> <span class=o>=</span> <span class=s1>&#39;docs/chroma/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>embedding</span> <span class=o>=</span> <span class=n>OpenAIEmbeddings</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>vectordb</span> <span class=o>=</span> <span class=n>Chroma</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>persist_directory</span><span class=o>=</span><span class=n>persist_directory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>embedding_function</span><span class=o>=</span><span class=n>embedding</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2ç”¨å°‘é‡ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå°å‹æ•°æ®åº“>æ­¥éª¤2ï¼šç”¨å°‘é‡ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå°å‹æ•°æ®åº“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># é¹…è†èŒæœ‰ä¸€ä¸ªå·¨å¤§è€Œé›„ä¼Ÿçš„å­å®ä½“(åœ°ä¸Šéƒ¨åˆ†)ã€‚</span>
</span></span><span class=line><span class=cl><span class=c1># æœ‰å¤§å­å®ä½“çš„è˜‘è‡æ˜¯é¹…è†èŒã€‚æœ‰äº›å“ç§æ˜¯å…¨ç™½è‰²çš„ã€‚</span>
</span></span><span class=line><span class=cl><span class=c1># é¹…è†èŒï¼Œåˆå«æ­»äº¡å¸½ï¼Œæ˜¯æ‰€æœ‰å·²çŸ¥è˜‘è‡ä¸­æ¯’æ€§æœ€å¼ºçš„ä¸€ç§ã€‚</span>
</span></span><span class=line><span class=cl><span class=n>texts</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;The Amanita phalloides has a large and imposing epigeous (aboveground) fruiting body (basidiocarp).&#34;&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;A mushroom with a large fruiting body is the Amanita phalloides. Some varieties are all-white.&#34;&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;A. phalloides, a.k.a Death Cap, is one of the most poisonous of all known mushrooms.&#34;&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>smalldb</span> <span class=o>=</span> <span class=n>Chroma</span><span class=o>.</span><span class=n>from_texts</span><span class=p>(</span><span class=n>texts</span><span class=p>,</span> <span class=n>embedding</span><span class=o>=</span><span class=n>embedding</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3è¿›è¡Œç›¸ä¼¼æ€§æœç´¢>æ­¥éª¤3ï¼šè¿›è¡Œç›¸ä¼¼æ€§æœç´¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># å‘Šè¯‰æˆ‘æœ‰å…³å¸¦æœ‰å¤§å­å®ä½“çš„å…¨ç™½è˜‘è‡çš„ä¿¡æ¯</span>
</span></span><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;Tell me about all-white mushrooms with large fruiting bodies&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>smalldb</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span> <span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [Document(page_content=&#39;A mushroom with a large fruiting body is the Amanita phalloides. Some varieties are all-white.&#39;, metadata={}),</span>
</span></span><span class=line><span class=cl><span class=c1># Document(page_content=&#39;The Amanita phalloides has a large and imposing epigeous (aboveground) fruiting body (basidiocarp).&#39;, metadata={})]</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ ¹æ®kå€¼è¿”å›äº†ä¸¤ä¸ªæœ€ç›¸å…³çš„æ–‡æ¡£ï¼Œä½†æ²¡æœ‰æåˆ°å®ƒä»¬æœ‰æ¯’çš„äº‹å®ã€‚</p><h3 id=æ­¥éª¤4è¿›è¡Œmmræœç´¢>æ­¥éª¤4ï¼šè¿›è¡ŒMMRæœç´¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>smalldb</span><span class=o>.</span><span class=n>max_marginal_relevance_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span><span class=n>k</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>fetch_k</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># [Document(page_content=&#39;A mushroom with a large fruiting body is the Amanita phalloides. Some varieties are all-white.&#39;, metadata={}),</span>
</span></span><span class=line><span class=cl><span class=c1># Document(page_content=&#39;A. phalloides, a.k.a Death Cap, is one of the most poisonous of all known mushrooms.&#39;, metadata={})]</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥äº†"k=2"ï¼Œè¡¨ç¤ºä»ç„¶æƒ³è¿”å›ä¸¤ä¸ªæ–‡æ¡£ï¼Œä½†æˆ‘ä»¬è®¾ç½®äº†"fetch_k=3"ï¼Œè¡¨ç¤ºæƒ³è·å–ä¸‰ä¸ªæ–‡æ¡£ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›çš„æ–‡æ¡£ä¸­åŒ…å«äº†å®ƒä»¬æœ‰æ¯’çš„äº‹å®ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è¯•ç€ç”¨è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†ä¸Šä¸€èŠ‚è¯¾ä¸­çš„å¤±è´¥æƒ…å†µ1ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about matlab?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>docs_mmr</span> <span class=o>=</span> <span class=n>vectordb</span><span class=o>.</span><span class=n>max_marginal_relevance_search</span><span class=p>(</span><span class=n>question</span><span class=p>,</span><span class=n>k</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs_mmr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>[:</span><span class=mi>100</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;those homeworks will be done in either MATLA B or in Octave, which is sort of â€” I \nknow some people &#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs_mmr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>page_content</span><span class=p>[:</span><span class=mi>100</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># &#39;algorithm then? So whatâ€™s different? How come  I was making all that noise earlier about \nleast squa&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªæ–‡æ¡£è·Ÿä¹‹å‰ä¸€æ ·ï¼Œå› ä¸ºå®ƒæœ€ç›¸å…³ã€‚è€Œç¬¬äºŒä¸ªæ–‡æ¡£è¿™æ¬¡å°±ä¸åŒäº†ï¼Œè¿™è¯´æ˜MMRè®©å›ç­”ä¸­å¢åŠ äº†ä¸€äº›å¤šæ ·æ€§ã€‚</p><h2 id=è§£å†³ç‰¹æ®Šæ€§ä½¿ç”¨è‡ªæŸ¥è¯¢æ£€ç´¢å™¨å¤„ç†å…ƒæ•°æ®>è§£å†³ç‰¹æ®Šæ€§ï¼šä½¿ç”¨è‡ªæŸ¥è¯¢æ£€ç´¢å™¨å¤„ç†å…ƒæ•°æ®</h2><p>è‡ªæŸ¥è¯¢ä½¿ç”¨è¯­è¨€æ¨¡å‹å°†åŸå§‹é—®é¢˜åˆ†å‰²ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªè¿‡æ»¤å™¨å’Œä¸€ä¸ªæœç´¢é¡¹ã€‚</p><p>æœç´¢é¡¹å°±æ˜¯æˆ‘ä»¬åœ¨è¯­ä¹‰ä¸Šæƒ³è¦æŸ¥æ‰¾çš„é—®é¢˜å†…å®¹ã€‚</p><p>è¿‡æ»¤å™¨åˆ™æ˜¯åŒ…å«æˆ‘ä»¬æƒ³è¦è¿‡æ»¤çš„å…ƒæ•°æ®ã€‚</p><p>æ¯”å¦‚ï¼Œâ€œ1980å¹´åˆ¶ä½œçš„å…³äºå¤–æ˜Ÿäººçš„ç”µå½±æœ‰å“ªäº›â€ï¼Œè¯­ä¹‰éƒ¨åˆ†å°±æ˜¯â€œå…³äºå¤–æ˜Ÿäººçš„ç”µå½±â€ï¼Œå…ƒæ•°æ®éƒ¨åˆ†åˆ™æ˜¯â€œç”µå½±å¹´ä»½åº”ä¸º1980å¹´â€ã€‚</p><p>æˆ‘ä»¬å…ˆæ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªå…ƒæ•°æ®è¿‡æ»¤å™¨æ¥éªŒè¯å®ƒçš„æ•ˆæœã€‚</p><p>ç›®æ ‡æ˜¯å¤„ç†ä¸Šä¸€èŠ‚è¯¾çš„å¤±è´¥æƒ…å†µ2ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about regression in the third lecture?&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># æŒ‡å®šæºä¸ºç¬¬ä¸‰å ‚è¯¾çš„PDFæ–‡æ¡£</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>vectordb</span><span class=o>.</span><span class=n>similarity_search</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>question</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nb>filter</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;source&#34;</span><span class=p>:</span><span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>docs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 0}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 14}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 4} </span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨æ£€ç´¢åˆ°çš„æ–‡æ¡£éƒ½æ¥è‡ªé‚£ä¸€å ‚è¯¾äº†ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>SelfQueryRetriever</code>ï¼Œä»é—®é¢˜æœ¬èº«æ¨æ–­å‡ºå…ƒæ•°æ®ã€‚</p><h3 id=æ­¥éª¤1æä¾›å…ƒæ•°æ®å­—æ®µä¿¡æ¯>æ­¥éª¤1ï¼šæä¾›å…ƒæ•°æ®å­—æ®µä¿¡æ¯</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.llms</span> <span class=kn>import</span> <span class=n>OpenAI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.retrievers.self_query.base</span> <span class=kn>import</span> <span class=n>SelfQueryRetriever</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chains.query_constructor.base</span> <span class=kn>import</span> <span class=n>AttributeInfo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>metadata_field_info</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>AttributeInfo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=o>=</span><span class=s2>&#34;source&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;The lecture the chunk is from, should be one of `docs/cs229_lectures/MachineLearning-Lecture01.pdf`, `docs/cs229_lectures/MachineLearning-Lecture02.pdf`, or `docs/cs229_lectures/MachineLearning-Lecture03.pdf`&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;string&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>AttributeInfo</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=o>=</span><span class=s2>&#34;page&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;The page from the lecture&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>type</span><span class=o>=</span><span class=s2>&#34;integer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªä¾‹å­ä¸­çš„å…ƒæ•°æ®åªæœ‰ä¸¤ä¸ªå­—æ®µï¼Œæºï¼ˆsourceï¼‰å’Œé¡µï¼ˆpageï¼‰ã€‚æˆ‘ä»¬éœ€è¦å¡«å†™æ¯ä¸ªå­—æ®µçš„åç§°ã€æè¿°å’Œç±»å‹ã€‚è¿™äº›ä¿¡æ¯ä¼šè¢«ä¼ ç»™è¯­è¨€æ¨¡å‹ï¼Œæ‰€ä»¥éœ€è¦å°½å¯èƒ½æè¿°å¾—æ¸…æ¥šã€‚</p><h3 id=æ­¥éª¤2åˆå§‹åŒ–è‡ªæŸ¥è¯¢æ£€ç´¢å™¨>æ­¥éª¤2ï¼šåˆå§‹åŒ–è‡ªæŸ¥è¯¢æ£€ç´¢å™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æŒ‡å®šæ–‡æ¡£å®é™…å†…å®¹çš„ä¿¡æ¯</span>
</span></span><span class=line><span class=cl><span class=n>document_content_description</span> <span class=o>=</span> <span class=s2>&#34;Lecture notes&#34;</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>(</span><span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>retriever</span> <span class=o>=</span> <span class=n>SelfQueryRetriever</span><span class=o>.</span><span class=n>from_llm</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>vectordb</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>document_content_description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata_field_info</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3è¿è¡Œè‡ªæŸ¥è¯¢æ£€ç´¢å™¨æœç´¢é—®é¢˜>æ­¥éª¤3ï¼šè¿è¡Œè‡ªæŸ¥è¯¢æ£€ç´¢å™¨æœç´¢é—®é¢˜</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about regression in the third lecture?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=n>retriever</span><span class=o>.</span><span class=n>get_relevant_documents</span><span class=p>(</span><span class=n>question</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>docs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d</span><span class=o>.</span><span class=n>metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 0}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 14}</span>
</span></span><span class=line><span class=cl><span class=c1># {&#39;source&#39;: &#39;docs/cs229_lectures/MachineLearning-Lecture03.pdf&#39;, &#39;page&#39;: 4} </span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯­ä¹‰éƒ¨åˆ†è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå…³äºå›å½’çš„æŸ¥è¯¢ã€‚è¿‡æ»¤å™¨éƒ¨åˆ†è¡¨æ˜æˆ‘ä»¬åªæƒ³çœ‹é‚£äº›sourceå€¼ä¸ºæŒ‡å®šå€¼çš„æ–‡æ¡£ã€‚</p><p>è€Œä»æ‰“å°å‡ºçš„å…ƒæ•°æ®çœ‹ï¼Œå®ƒä»¬éƒ½æ¥è‡ªæŒ‡å®šçš„é‚£ä¸€å ‚è¯¾ï¼Œè¯´æ˜è‡ªæŸ¥è¯¢æ£€ç´¢å™¨ç¡®å®å¯ä»¥ç”¨æ¥ç²¾ç¡®åœ°è¿›è¡Œå…ƒæ•°æ®è¿‡æ»¤ã€‚</p><h2 id=è§£å†³ç›¸å…³æ€§ä½¿ç”¨ä¸Šä¸‹æ–‡å‹ç¼©æå–å‡ºä¸æŸ¥è¯¢æœ€ç›¸å…³çš„éƒ¨åˆ†>è§£å†³ç›¸å…³æ€§ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡å‹ç¼©æå–å‡ºä¸æŸ¥è¯¢æœ€ç›¸å…³çš„éƒ¨åˆ†</h2><p>æé«˜æ£€ç´¢æ–‡æ¡£è´¨é‡çš„å¦ä¸€ç§æ–¹æ³•æ˜¯å‹ç¼©ã€‚</p><p>å½“ä½ æå‡ºä¸€ä¸ªé—®é¢˜æ—¶ï¼Œä½ ä¼šå¾—åˆ°æ•´ä¸ªå­˜å‚¨çš„æ–‡æ¡£ï¼Œä½†å¯èƒ½åªæœ‰å…¶ä¸­ä¸€å°éƒ¨åˆ†æ˜¯è·Ÿé—®é¢˜ç›¸å…³çš„ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æŸ¥è¯¢æœ€ç›¸å…³çš„ä¿¡æ¯å¯èƒ½è¢«éšè—åœ¨åŒ…å«å¤§é‡æ— å…³æ–‡æœ¬çš„æ–‡æ¡£é‡Œã€‚</p><p>ä¸Šä¸‹æ–‡å‹ç¼©å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p><p><strong>é€šè¿‡å‹ç¼©ï¼Œä½ å¯ä»¥å…ˆè®©è¯­è¨€æ¨¡å‹æå–å‡ºæœ€ç›¸å…³çš„ç‰‡æ®µï¼Œç„¶ååªæŠŠæœ€ç›¸å…³çš„ç‰‡æ®µä¼ ç»™æœ€ç»ˆçš„è¯­è¨€æ¨¡å‹è°ƒç”¨</strong>ã€‚</p><p>è¿™ä¼šå¢åŠ è¯­è¨€æ¨¡å‹è°ƒç”¨çš„æˆæœ¬ï¼Œä½†ä¹Ÿä¼šè®©æœ€ç»ˆçš„ç­”æ¡ˆæ›´é›†ä¸­åœ¨æœ€é‡è¦çš„å†…å®¹ä¸Šï¼Œè¿™éœ€è¦æˆ‘ä»¬è‡ªå·±æƒè¡¡ã€‚</p><h3 id=æ­¥éª¤1åˆ›å»ºä¸Šä¸‹æ–‡å‹ç¼©æ£€ç´¢å™¨>æ­¥éª¤1ï¼šåˆ›å»ºä¸Šä¸‹æ–‡å‹ç¼©æ£€ç´¢å™¨</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.retrievers</span> <span class=kn>import</span> <span class=n>ContextualCompressionRetriever</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.retrievers.document_compressors</span> <span class=kn>import</span> <span class=n>LLMChainExtractor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åŒ…è£…æˆ‘ä»¬çš„å‘é‡å­˜å‚¨</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>(</span><span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>compressor</span> <span class=o>=</span> <span class=n>LLMChainExtractor</span><span class=o>.</span><span class=n>from_llm</span><span class=p>(</span><span class=n>llm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>compression_retriever</span> <span class=o>=</span> <span class=n>ContextualCompressionRetriever</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>base_compressor</span><span class=o>=</span><span class=n>compressor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>base_retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2æå‡ºé—®é¢˜æ£€ç´¢å‹ç¼©åçš„ç›¸å…³æ–‡æ¡£>æ­¥éª¤2ï¼šæå‡ºé—®é¢˜ï¼Œæ£€ç´¢å‹ç¼©åçš„ç›¸å…³æ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about matlab?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>compressed_docs</span> <span class=o>=</span> <span class=n>compression_retriever</span><span class=o>.</span><span class=n>get_relevant_documents</span><span class=p>(</span><span class=n>question</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pretty_print_docs</span><span class=p>(</span><span class=n>compressed_docs</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»å‹ç¼©åçš„æ–‡æ¡£æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ ä¸€ï¼Œå®ƒä»¬æ¯”æ™®é€šçš„æ–‡æ¡£çŸ­å¾—å¤šï¼› äºŒï¼Œä»ç„¶æœ‰é‡å¤çš„å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºåº•å±‚æˆ‘ä»¬è¿˜æ˜¯ç”¨çš„è¯­ä¹‰æœç´¢ç®—æ³•ã€‚</p><p>ä¸ºäº†è§£å†³å†…å®¹é‡å¤çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºæ£€ç´¢å™¨æ—¶ï¼Œç»“åˆå‰é¢çš„å†…å®¹ï¼ŒæŠŠæœç´¢ç±»å‹è®¾ç½®ä¸ºMMRã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>compression_retriever</span> <span class=o>=</span> <span class=n>ContextualCompressionRetriever</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>base_compressor</span><span class=o>=</span><span class=n>compressor</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>base_retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(</span><span class=n>search_type</span> <span class=o>=</span> <span class=s2>&#34;mmr&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;what did they say about matlab?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>compressed_docs</span> <span class=o>=</span> <span class=n>compression_retriever</span><span class=o>.</span><span class=n>get_relevant_documents</span><span class=p>(</span><span class=n>question</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pretty_print_docs</span><span class=p>(</span><span class=n>compressed_docs</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é‡æ–°è¿è¡Œä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°çš„å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰ä»»ä½•é‡å¤ä¿¡æ¯çš„è¿‡æ»¤åçš„ç»“æœé›†äº†ã€‚</p><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨è¿™äº›æ£€ç´¢åˆ°çš„æ–‡æ¡£æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</p><h2 id=é—®ç­”>é—®ç­”</h2><p>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ©ç”¨æ£€ç´¢åˆ°çš„æ–‡æ¡£æ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</p><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.56.33.png width=1590 height=1500 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.56.33_hu4b720dde1dec598afcf107b1b473af97_416237_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.56.33_hu4b720dde1dec598afcf107b1b473af97_416237_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=106 data-flex-basis=254px></p><p>æ•´ä¸ªè¿‡ç¨‹å¯ä»¥æ‹†åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç”¨æˆ·è¾“å…¥ä¸€ä¸ªé—®é¢˜ï¼ˆQuestionï¼‰</li><li>ä»å‘é‡å­˜å‚¨ï¼ˆStoreï¼‰ä¸­æ£€ç´¢å‡ºä¸é—®é¢˜ç›¸å…³çš„æ–‡æ¡£åˆ†å—ï¼ˆRelavant splitsï¼‰</li><li>å°†è¿™äº›åˆ†å—è¿åŒç³»ç»Ÿæç¤ºï¼ˆSystem:Promptï¼‰å’Œç”¨æˆ·é—®é¢˜ï¼ˆHuman:Questionï¼‰ä¸€èµ·ä½œä¸ºè¾“å…¥ä¼ ç»™è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰</li><li>è¯­è¨€æ¨¡å‹æ ¹æ®è¾“å…¥ç”Ÿæˆç­”æ¡ˆï¼ˆAnswerï¼‰</li></ol><p>é»˜è®¤ä½¿ç”¨çš„æ˜¯<code>stuff</code>æ–¹æ³•ï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><div class=table-wrapper><table><thead><tr><th>ç‰¹ç‚¹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>å°†æ‰€æœ‰æ£€ç´¢åˆ°çš„åˆ†å—æ”¾å…¥åŒä¸€ä¸ªä¸Šä¸‹æ–‡çª—å£ä¸­ï¼Œåªéœ€è¦å¯¹è¯­è¨€æ¨¡å‹è¿›è¡Œä¸€æ¬¡è°ƒç”¨ã€‚</td><td>ç®€å•ã€å»‰ä»·ä¸”æ•ˆæœä¸é”™ã€‚</td><td>å½“æ£€ç´¢åˆ°çš„æ–‡æ¡£è¿‡å¤šæ—¶ï¼Œç”±äºä¸Šä¸‹æ–‡çª—å£é•¿åº¦æœ‰é™ï¼Œå¯èƒ½æ— æ³•å°†æ‰€æœ‰åˆ†å—éƒ½ä¼ å…¥ã€‚</td></tr></tbody></table></div><p><img src=/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.57.35.png width=1542 height=1538 srcset="/p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.57.35_hue19c129da1903c418fc91f87618e507c_474016_480x0_resize_box_3.png 480w, /p/iii-%E5%9F%BA%E4%BA%8E%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E4%BD%BF%E7%94%A8langchain%E6%9E%84%E5%BB%BA%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA/iShot_2023-08-30_22.57.35_hue19c129da1903c418fc91f87618e507c_474016_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=100 data-flex-basis=240px></p><p>ä¸ºäº†è§£å†³ä¸Šä¸‹æ–‡çª—å£é•¿åº¦é™åˆ¶çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Map-reduce</code>ã€<code>Refine</code>å’Œ<code>Map-rerank</code>ä¸‰ç§æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•æˆ‘ä»¬åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­å·²ç»ç®€è¦ä»‹ç»è¿‡äº†ï¼Œä»Šå¤©æˆ‘ä»¬å°†è¿›ä¸€æ­¥æ·±å…¥äº†è§£ã€‚</p><h2 id=stuff>stuff</h2><h3 id=æ­¥éª¤1åŠ è½½ä¹‹å‰ä¿å­˜çš„å‘é‡æ•°æ®åº“>æ­¥éª¤1ï¼šåŠ è½½ä¹‹å‰ä¿å­˜çš„å‘é‡æ•°æ®åº“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.embeddings.openai</span> <span class=kn>import</span> <span class=n>OpenAIEmbeddings</span>
</span></span><span class=line><span class=cl><span class=n>persist_directory</span> <span class=o>=</span> <span class=s1>&#39;docs/chroma/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>embedding</span> <span class=o>=</span> <span class=n>OpenAIEmbeddings</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>vectordb</span> <span class=o>=</span> <span class=n>Chroma</span><span class=p>(</span><span class=n>persist_directory</span><span class=o>=</span><span class=n>persist_directory</span><span class=p>,</span> <span class=n>embedding_function</span><span class=o>=</span><span class=n>embedding</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2åˆå§‹åŒ–å°†ç”¨äºå›ç­”é—®é¢˜çš„è¯­è¨€æ¨¡å‹>æ­¥éª¤2ï¼šåˆå§‹åŒ–å°†ç”¨äºå›ç­”é—®é¢˜çš„è¯­è¨€æ¨¡å‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>llm_name</span> <span class=o>=</span> <span class=s2>&#34;gpt-3.5-turbo&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chat_models</span> <span class=kn>import</span> <span class=n>ChatOpenAI</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatOpenAI</span><span class=p>(</span><span class=n>model_name</span><span class=o>=</span><span class=n>llm_name</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>temperatureå‚æ•°è®¾ç½®ä¸º0ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¾—åˆ°æ›´å‡†ç¡®çš„ç­”æ¡ˆï¼Œå› ä¸ºå®ƒé™ä½äº†è¯­è¨€æ¨¡å‹çš„å¯å˜æ€§ï¼Œé€šå¸¸èƒ½ç»™æˆ‘ä»¬æœ€é«˜ç½®ä¿¡åº¦ã€æœ€å¯é çš„ç­”æ¡ˆã€‚</p><h3 id=æ­¥éª¤3å¯¼å…¥åˆ›å»ºè°ƒç”¨æ£€ç´¢é—®ç­”é“¾è¾“å…¥é—®é¢˜å¹¶è·å–ç­”æ¡ˆ>æ­¥éª¤3ï¼šå¯¼å…¥ã€åˆ›å»ºã€è°ƒç”¨æ£€ç´¢é—®ç­”é“¾ï¼Œè¾“å…¥é—®é¢˜ï¼Œå¹¶è·å–ç­”æ¡ˆ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;What are major topics for this class?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chains</span> <span class=kn>import</span> <span class=n>RetrievalQA</span>
</span></span><span class=line><span class=cl><span class=n>qa_chain</span> <span class=o>=</span> <span class=n>RetrievalQA</span><span class=o>.</span><span class=n>from_chain_type</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>qa_chain</span><span class=p>({</span><span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=n>question</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>&lsquo;The major topic for this class is machine learning. Additionally, the class may cover statistics and algebra as refreshers in the discussion sections. Later in the quarter, the discussion sections will also cover extensions for the material taught in the main lectures.&rsquo;</p></blockquote><h3 id=æ­¥éª¤4ä½¿ç”¨æç¤ºæ¨¡æ¿ä¼˜åŒ–è¾“å‡ºç»“æœ>æ­¥éª¤4ï¼šä½¿ç”¨æç¤ºæ¨¡æ¿ä¼˜åŒ–è¾“å‡ºç»“æœ</h3><p>æç¤ºæ¨¡æ¿æ˜¯ä¸€ç§å¯ä»¥å¸®åŠ©è¯­è¨€æ¨¡å‹ç”Ÿæˆæ›´ç¬¦åˆè¦æ±‚çš„è¾“å‡ºç»“æœçš„æŠ€å·§ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æç¤ºæ¨¡æ¿ä¸»è¦æ˜¯ä¸ºäº†è®©è¾“å‡ºç»“æœæ›´ç®€æ´ã€æ›´å°‘ç¼–é€ ã€æ›´ç¤¼è²Œã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.prompts</span> <span class=kn>import</span> <span class=n>PromptTemplate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ„å»ºæç¤ºè¯</span>
</span></span><span class=line><span class=cl><span class=c1># {context}ï¼šä¸Šä¸‹æ–‡å ä½ç¬¦ï¼Œç”¨äºæ”¾ç½®æ–‡æ¡£å†…å®¹</span>
</span></span><span class=line><span class=cl><span class=c1># {question}ï¼šé—®é¢˜å ä½ç¬¦ï¼Œæ”¾ç½®è¦æŸ¥è¯¢çš„é—®é¢˜</span>
</span></span><span class=line><span class=cl><span class=n>template</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;Use the following pieces of context to answer the question at the end. If you don&#39;t know the answer, just say that you don&#39;t know, don&#39;t try to make up an answer. Use three sentences maximum. Keep the answer as concise as possible. Always say &#34;thanks for asking!&#34; at the end of the answer. 
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=si>{context}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Question: </span><span class=si>{question}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Helpful Answer:&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>QA_CHAIN_PROMPT</span> <span class=o>=</span> <span class=n>PromptTemplate</span><span class=o>.</span><span class=n>from_template</span><span class=p>(</span><span class=n>template</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿è¡Œé“¾</span>
</span></span><span class=line><span class=cl><span class=c1># return_source_documents=Trueç”¨äºæ”¯æŒæŸ¥çœ‹æ£€ç´¢åˆ°çš„æ–‡æ¡£</span>
</span></span><span class=line><span class=cl><span class=n>qa_chain</span> <span class=o>=</span> <span class=n>RetrievalQA</span><span class=o>.</span><span class=n>from_chain_type</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>return_source_documents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chain_type_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;prompt&#34;</span><span class=p>:</span> <span class=n>QA_CHAIN_PROMPT</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>question</span> <span class=o>=</span> <span class=s2>&#34;Is probability a class topic?&#34;</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>qa_chain</span><span class=p>({</span><span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=n>question</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>&lsquo;Yes, probability is assumed to be a prerequisite for this class. The instructor assumes familiarity with basic probability and statistics, and will go over some of the prerequisites in the discussion sections as a refresher course. Thanks for asking!&rsquo;</p></blockquote><h3 id=æ­¥éª¤5æŸ¥çœ‹è¿”å›çš„æºæ–‡æ¡£ç†è§£å…¶ä»å“ªé‡Œè·å–æ•°æ®>æ­¥éª¤5ï¼šæŸ¥çœ‹è¿”å›çš„æºæ–‡æ¡£ï¼Œç†è§£å…¶ä»å“ªé‡Œè·å–æ•°æ®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>result</span><span class=p>[</span><span class=s2>&#34;source_documents&#34;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Document(page_content=&ldquo;of this class will not be very program ming intensive, although we will do some \nprogramming, mostly in either MATLAB or Octa ve. I&rsquo;ll say a bit more about that later. \nI also assume familiarity with basic proba bility and statistics. So most undergraduate \nstatistics class, like Stat 116 taught here at Stanford, will be more than enough. I&rsquo;m gonna \nassume all of you know what ra ndom variables are, that all of you know what expectation \nis, what a variance or a random variable is. And in case of some of you, it&rsquo;s been a while \nsince you&rsquo;ve seen some of this material. At some of the discussion sections, we&rsquo;ll actually \ngo over some of the prerequisites, sort of as a refresher course under prerequisite class. \nI&rsquo;ll say a bit more about that later as well. \nLastly, I also assume familiarity with basi c linear algebra. And again, most undergraduate \nlinear algebra courses are more than enough. So if you&rsquo;ve taken courses like Math 51, \n103, Math 113 or CS205 at Stanford, that would be more than enough. Basically, I&rsquo;m \ngonna assume that all of you know what matrix es and vectors are, that you know how to \nmultiply matrices and vectors and multiply matrix and matrices, that you know what a matrix inverse is. If you know what an eigenvect or of a matrix is, that&rsquo;d be even better. \nBut if you don&rsquo;t quite know or if you&rsquo;re not qu ite sure, that&rsquo;s fine, too. We&rsquo;ll go over it in \nthe review sections.&rdquo;, metadata={&lsquo;source&rsquo;: &lsquo;docs/cs229_lectures/MachineLearning-Lecture01.pdf&rsquo;, &lsquo;page&rsquo;: 4})</p></blockquote><h2 id=map-reduce>Map-reduce</h2><p>Map-reduceæ–¹æ³•çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><div class=table-wrapper><table><thead><tr><th>ç‰¹ç‚¹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>1.å°†æ¯ä¸ªæ–‡æ¡£å•ç‹¬å‘é€åˆ°è¯­è¨€æ¨¡å‹ä¸­ï¼Œæ ¹æ®å•ä¸ªæ–‡æ¡£ç”Ÿæˆç­”æ¡ˆï¼›</td><td>å¯ä»¥å¤„ç†ä»»æ„æ•°é‡çš„æ–‡æ¡£ã€‚</td><td>1.æ¶‰åŠåˆ°å¯¹è¯­è¨€æ¨¡å‹çš„å¤šæ¬¡è°ƒç”¨ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼›</td></tr><tr><td>2.å°†æ‰€æœ‰è¿™äº›ç­”æ¡ˆç»„åˆåœ¨ä¸€èµ·ï¼Œå†è°ƒç”¨è¯­è¨€æ¨¡å‹ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚</td><td></td><td>2.ä¿¡æ¯å¯èƒ½åˆ†æ•£åœ¨ä¸åŒçš„æ–‡æ¡£ä¸­ï¼Œæ— æ³•åŸºäºåŒä¸€ä¸ªä¸Šä¸‹æ–‡è·å–ä¿¡æ¯ï¼Œç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>qa_chain_mr</span> <span class=o>=</span> <span class=n>RetrievalQA</span><span class=o>.</span><span class=n>from_chain_type</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>chain_type</span><span class=o>=</span><span class=s2>&#34;map_reduce&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>qa_chain_mr</span><span class=p>({</span><span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=n>question</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>&lsquo;There is no clear answer to this question based on the given portion of the document. The document mentions familiarity with basic probability and statistics as a prerequisite for the class, and there is a brief mention of probability in the text, but it is not clear if it is a main topic of the class.&rsquo;</p></blockquote><h3 id=ä½¿ç”¨langsmithå¹³å°äº†è§£è¿™äº›é“¾å†…éƒ¨çš„è°ƒç”¨æƒ…å†µ>ä½¿ç”¨LangSmithå¹³å°äº†è§£è¿™äº›é“¾å†…éƒ¨çš„è°ƒç”¨æƒ…å†µ</h3><p>LangSmith æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”Ÿäº§çº§ LLM åº”ç”¨ç¨‹åºçš„å¹³å°ã€‚</p><p>å®ƒå¯ä»¥è®©æ‚¨è½»æ¾åœ°è°ƒè¯•ã€æµ‹è¯•ã€è¯„ä¼°å’Œç›‘æ§åŸºäºä»»ä½• LLM æ¡†æ¶æ„å»ºçš„é“¾å’Œæ™ºèƒ½ä»£ç†ï¼Œå¹¶ä¸ä½¿ç”¨ LLM æ„å»ºçš„å¼€æºæ¡†æ¶ LangChain å®Œç¾é›†æˆã€‚</p><p>è¦ä½“éªŒè¿™ä¸ªå¹³å°çš„åŠŸèƒ½ï¼Œä½ éœ€è¦ï¼š</p><ol><li>å‰å¾€<a class=link href="https://link.juejin.cn/?target=https%3A%2F%2Fsmith.langchain.com%2F" title=https://smith.langchain.com/ target=_blank rel=noopener>LangSmithå¹³å°</a>æ³¨å†Œï¼ˆå¯èƒ½éœ€è¦æ’é˜Ÿï¼‰</li><li>åˆ›å»º API å¯†é’¥</li><li>åœ¨ä»¥ä¸‹ä»£ç ä¸­ä½¿ç”¨è¿™ä¸ª API å¯†é’¥</li><li>å–æ¶ˆæ³¨é‡Šä»¥ä¸‹ä»£ç ï¼Œå¹¶é‡æ–°è¿è¡ŒMapReduceé“¾</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;LANGCHAIN_TRACING_V2&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;LANGCHAIN_ENDPOINT&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;https://api.langchain.plus&#34;</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&#34;LANGCHAIN_API_KEY&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;...&#34;</span> <span class=c1># æ›¿æ¢...ä¸ºä½ çš„ API å¯†é’¥</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¹‹åï¼Œå°±å¯ä»¥åˆ‡æ¢åˆ°LangSmithå¹³å°ï¼Œæ‰¾åˆ°åˆšåˆšè¿è¡Œçš„RetrievalQAï¼ŒæŸ¥çœ‹è¾“å…¥ã€è¾“å‡ºä»¥åŠè°ƒç”¨é“¾äº†ï¼š</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒMapReduceDocumentChainä¸­æ¶‰åŠåˆ°äº†å¯¹è¯­è¨€æ¨¡å‹çš„å››æ¬¡ç‹¬ç«‹è°ƒç”¨ï¼Œç‚¹å‡»å…¶ä¸­ä¸€ä¸ªï¼Œå°±å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ–‡æ¡£çš„å…·ä½“è¾“å…¥å’Œè¾“å‡ºï¼š</p><p>å¹¶ä¸”ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬åœ¨æœ€åçš„é“¾ä¸­è¢«åˆå¹¶ä¸ºäº†StuffDocumentChainï¼Œä¹Ÿå³æŠŠæ‰€æœ‰ç»“æœæ”¾åˆ°äº†æœ€ç»ˆè°ƒç”¨ä¸­ã€‚ç‚¹å‡»è¿›å…¥å°±å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿæ¶ˆæ¯ä¸­åŒ…å«äº†æ¥è‡ªå‰é¢æ–‡æ¡£çš„å››ä¸ªæ‘˜è¦ï¼š</p><h2 id=refine>Refine</h2><p>Refineæ–¹æ³•çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><div class=table-wrapper><table><thead><tr><th>ç‰¹ç‚¹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>è¿­ä»£åœ°å¤„ç†å¤šä¸ªæ–‡æ¡£ï¼ŒåŸºäºå‰ä¸€ä¸ªæ–‡æ¡£çš„ç­”æ¡ˆæ¥æ„å»ºä¸€ä¸ªæ›´å¥½çš„ç­”æ¡ˆã€‚</td><td>å…è®¸ç»„åˆä¿¡æ¯ï¼Œæ›´é¼“åŠ±ä¿¡æ¯çš„ä¼ é€’</td><td>é€Ÿåº¦è¾ƒæ…¢</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>qa_chain_mr</span> <span class=o>=</span> <span class=n>RetrievalQA</span><span class=o>.</span><span class=n>from_chain_type</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>chain_type</span><span class=o>=</span><span class=s2>&#34;refine&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>qa_chain_mr</span><span class=p>({</span><span class=s2>&#34;query&#34;</span><span class=p>:</span> <span class=n>question</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>result</span><span class=p>[</span><span class=s2>&#34;result&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>&ldquo;The main topic of the class is machine learning algorithms, including linear regression and classification. Basic probability and statistics, as well as linear algebra, are prerequisites for the class, but the instructor will provide a refresher course on these topics in some of the discussion sections. Later in the quarter, the discussion sections will also cover extensions for the material taught in the main lectures. The instructor will focus on a few important extensions that there wasn&rsquo;t enough time to cover in the main lectures.&rdquo;</p></blockquote><p>ç°åœ¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„é“¾æ˜¯æ²¡æœ‰â€œè®°å¿†â€è¿™ä¸ªæ¦‚å¿µçš„ï¼Œè¿™å°±å¯¼è‡´äº†å®ƒä¸ä¼šè®°ä½ä¹‹å‰çš„é—®é¢˜æˆ–ç­”æ¡ˆã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥â€œè®°å¿†â€åŠŸèƒ½ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¸‹ä¸€èŠ‚è¦è®²çš„å†…å®¹ã€‚</p><h2 id=chat>Chat</h2><p>åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå®Œæ•´çš„é—®ç­”èŠå¤©æœºå™¨äººï¼Œå®ƒå°†ç»“åˆæˆ‘ä»¬ä¹‹å‰è®²è¿‡çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶å¼•å…¥â€œèŠå¤©å†å²â€è¿™ä¸ªæ¦‚å¿µï¼Œè®©å®ƒåœ¨å›ç­”é—®é¢˜æ—¶èƒ½å¤Ÿè€ƒè™‘åˆ°ä¹‹å‰çš„å¯¹è¯æˆ–ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒèƒ½è®°ä½ä½ ä¹‹å‰è¯´è¿‡ä»€ä¹ˆã€‚</p><h3 id=æ­¥éª¤1åˆå§‹åŒ–ç”¨äºä¿å­˜å¤§é‡æ–‡æ¡£å†…å®¹çš„å‘é‡æ•°æ®åº“>æ­¥éª¤1ï¼šåˆå§‹åŒ–ç”¨äºä¿å­˜å¤§é‡æ–‡æ¡£å†…å®¹çš„å‘é‡æ•°æ®åº“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.vectorstores</span> <span class=kn>import</span> <span class=n>Chroma</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.embeddings.openai</span> <span class=kn>import</span> <span class=n>OpenAIEmbeddings</span>
</span></span><span class=line><span class=cl><span class=n>persist_directory</span> <span class=o>=</span> <span class=s1>&#39;docs/chroma/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>embedding</span> <span class=o>=</span> <span class=n>OpenAIEmbeddings</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>vectordb</span> <span class=o>=</span> <span class=n>Chroma</span><span class=p>(</span><span class=n>persist_directory</span><span class=o>=</span><span class=n>persist_directory</span><span class=p>,</span> <span class=n>embedding_function</span><span class=o>=</span><span class=n>embedding</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤2åˆå§‹åŒ–å°†ä½œä¸ºèŠå¤©æœºå™¨äººä½¿ç”¨çš„è¯­è¨€æ¨¡å‹>æ­¥éª¤2ï¼šåˆå§‹åŒ–å°†ä½œä¸ºèŠå¤©æœºå™¨äººä½¿ç”¨çš„è¯­è¨€æ¨¡å‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>llm_name</span> <span class=o>=</span> <span class=s2>&#34;gpt-3.5-turbo&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chat_models</span> <span class=kn>import</span> <span class=n>ChatOpenAI</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatOpenAI</span><span class=p>(</span><span class=n>model_name</span><span class=o>=</span><span class=n>llm_name</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤3åˆå§‹åŒ–æç¤ºæ¨¡æ¿è®©è¾“å‡ºç»“æœæ›´ç®€ä»‹æ›´å°‘ç¼–é€ æ›´ç¤¼è²Œ>æ­¥éª¤3ï¼šåˆå§‹åŒ–æç¤ºæ¨¡æ¿ï¼Œè®©è¾“å‡ºç»“æœæ›´ç®€ä»‹ã€æ›´å°‘ç¼–é€ ã€æ›´ç¤¼è²Œ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># æ„å»ºæç¤º</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.prompts</span> <span class=kn>import</span> <span class=n>PromptTemplate</span>
</span></span><span class=line><span class=cl><span class=n>template</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;Use the following pieces of context to answer the question at the end. If you don&#39;t know the answer, just say that you don&#39;t know, don&#39;t try to make up an answer. Use three sentences maximum. Keep the answer as concise as possible. Always say &#34;thanks for asking!&#34; at the end of the answer. 
</span></span></span><span class=line><span class=cl><span class=s2></span><span class=si>{context}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Question: </span><span class=si>{question}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Helpful Answer:&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>QA_CHAIN_PROMPT</span> <span class=o>=</span> <span class=n>PromptTemplate</span><span class=p>(</span><span class=n>input_variables</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;context&#34;</span><span class=p>,</span> <span class=s2>&#34;question&#34;</span><span class=p>],</span><span class=n>template</span><span class=o>=</span><span class=n>template</span><span class=p>,)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤4åˆ›å»ºæ£€ç´¢qaé“¾ç”¨äºåˆå¹¶æ£€ç´¢åˆ°çš„æ–‡æœ¬ç‰‡æ®µå¹¶è°ƒç”¨è¯­è¨€æ¨¡å‹>æ­¥éª¤4ï¼šåˆ›å»ºæ£€ç´¢QAé“¾ï¼Œç”¨äºåˆå¹¶æ£€ç´¢åˆ°çš„æ–‡æœ¬ç‰‡æ®µå¹¶è°ƒç”¨è¯­è¨€æ¨¡å‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># è¿è¡Œé“¾</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chains</span> <span class=kn>import</span> <span class=n>RetrievalQA</span>
</span></span><span class=line><span class=cl><span class=n>qa_chain</span> <span class=o>=</span> <span class=n>RetrievalQA</span><span class=o>.</span><span class=n>from_chain_type</span><span class=p>(</span><span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                                       <span class=n>return_source_documents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=n>chain_type_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;prompt&#34;</span><span class=p>:</span> <span class=n>QA_CHAIN_PROMPT</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤5ä½¿ç”¨conversationbuffermemoryå¢åŠ èŠå¤©æœºå™¨äººçš„è®°å¿†åŠŸèƒ½>æ­¥éª¤5ï¼šä½¿ç”¨ConversationBufferMemoryå¢åŠ èŠå¤©æœºå™¨äººçš„è®°å¿†åŠŸèƒ½</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.memory</span> <span class=kn>import</span> <span class=n>ConversationBufferMemory</span>
</span></span><span class=line><span class=cl><span class=n>memory</span> <span class=o>=</span> <span class=n>ConversationBufferMemory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>memory_key</span><span class=o>=</span><span class=s2>&#34;chat_history&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>return_messages</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ConversationBufferMemoryæä¾›äº†ä¸€ä¸ªèŠå¤©æ¶ˆæ¯å†å²çš„è®°å¿†ç¼“å†²åŒºï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½ä¼šå°†è¿™éƒ¨åˆ†å†å²æ¶ˆæ¯ä¼ å…¥èŠå¤©æœºå™¨äººã€‚</p><p>return_messages=Trueè¡¨ç¤ºå°†è¿”å›ä¸€ä¸ªåˆ—è¡¨ç±»å‹çš„èŠå¤©å†å²è®°å½•ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><h3 id=æ­¥éª¤6åˆ›å»ºconversationalretrievalchainå¯¹è¯æ£€ç´¢é“¾ä¼ å…¥è¯­è¨€æ¨¡å‹æ£€ç´¢å™¨å’Œè®°å¿†ç³»ç»Ÿ>æ­¥éª¤6ï¼šåˆ›å»ºConversationalRetrievalChainï¼ˆå¯¹è¯æ£€ç´¢é“¾ï¼‰ï¼Œä¼ å…¥è¯­è¨€æ¨¡å‹ã€æ£€ç´¢å™¨å’Œè®°å¿†ç³»ç»Ÿ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chains</span> <span class=kn>import</span> <span class=n>ConversationalRetrievalChain</span>
</span></span><span class=line><span class=cl><span class=n>retriever</span><span class=o>=</span><span class=n>vectordb</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>qa</span> <span class=o>=</span> <span class=n>ConversationalRetrievalChain</span><span class=o>.</span><span class=n>from_llm</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>llm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span><span class=o>=</span><span class=n>retriever</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>memory</span><span class=o>=</span><span class=n>memory</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ConversationalRetrievalChainä¼šåœ¨RetrievalQAChainçš„åŸºç¡€ä¸Šï¼Œå°†èŠå¤©å†å²å’Œæ–°æçš„é—®é¢˜æ•´åˆæˆä¸€ä¸ªæ–°çš„ç‹¬ç«‹é—®é¢˜ï¼Œä»¥ä¼ é€’ç»™å‘é‡å­˜å‚¨åº“ï¼ŒæŸ¥æ‰¾ç›¸å…³æ–‡æ¡£ã€‚</p><h3 id=æ­¥éª¤7ä½¿ç”¨pypdfloaderåŠ è½½æ‰€è¦å‚è€ƒçš„æ–‡æ¡£>æ­¥éª¤7ï¼šä½¿ç”¨PyPDFLoaderåŠ è½½æ‰€è¦å‚è€ƒçš„æ–‡æ¡£</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.embeddings.openai</span> <span class=kn>import</span> <span class=n>OpenAIEmbeddings</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.text_splitter</span> <span class=kn>import</span> <span class=n>CharacterTextSplitter</span><span class=p>,</span> <span class=n>RecursiveCharacterTextSplitter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.vectorstores</span> <span class=kn>import</span> <span class=n>DocArrayInMemorySearch</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>TextLoader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chains</span> <span class=kn>import</span> <span class=n>RetrievalQA</span><span class=p>,</span>  <span class=n>ConversationalRetrievalChain</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.memory</span> <span class=kn>import</span> <span class=n>ConversationBufferMemory</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.chat_models</span> <span class=kn>import</span> <span class=n>ChatOpenAI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>TextLoader</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>langchain.document_loaders</span> <span class=kn>import</span> <span class=n>PyPDFLoader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_db</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>chain_type</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># åŠ è½½æ–‡æ¡£</span>
</span></span><span class=line><span class=cl>    <span class=n>loader</span> <span class=o>=</span> <span class=n>PyPDFLoader</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>documents</span> <span class=o>=</span> <span class=n>loader</span><span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤8åˆ†å‰²æ–‡æ¡£ä¸ºæ¯ä¸ªåˆ†å—åˆ›å»ºåµŒå…¥å¹¶å­˜å‚¨åˆ°å‘é‡å­˜å‚¨åº“ä¸­>æ­¥éª¤8ï¼šåˆ†å‰²æ–‡æ¡£ï¼Œä¸ºæ¯ä¸ªåˆ†å—åˆ›å»ºåµŒå…¥ï¼Œå¹¶å­˜å‚¨åˆ°å‘é‡å­˜å‚¨åº“ä¸­ã€‚</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_db</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>chain_type</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># åˆ†éš”æ–‡æ¡£</span>
</span></span><span class=line><span class=cl>    <span class=n>text_splitter</span> <span class=o>=</span> <span class=n>RecursiveCharacterTextSplitter</span><span class=p>(</span><span class=n>chunk_size</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>chunk_overlap</span><span class=o>=</span><span class=mi>150</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>docs</span> <span class=o>=</span> <span class=n>text_splitter</span><span class=o>.</span><span class=n>split_documents</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># å®šä¹‰åµŒå…¥</span>
</span></span><span class=line><span class=cl>    <span class=n>embeddings</span> <span class=o>=</span> <span class=n>OpenAIEmbeddings</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># åŸºäºæ–‡æ¡£æ•°æ®åˆ›å»ºå‘é‡æ•°æ®åº“</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>DocArrayInMemorySearch</span><span class=o>.</span><span class=n>from_documents</span><span class=p>(</span><span class=n>docs</span><span class=p>,</span> <span class=n>embeddings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤9ä»å‘é‡æ•°æ®åº“åˆ›å»ºä¸€ä¸ªåŸºäºç›¸ä¼¼åº¦çš„æ£€ç´¢å™¨>æ­¥éª¤9ï¼šä»å‘é‡æ•°æ®åº“åˆ›å»ºä¸€ä¸ªåŸºäºâ€œç›¸ä¼¼åº¦â€çš„æ£€ç´¢å™¨ã€‚</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_db</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>chain_type</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># å®šä¹‰æ£€ç´¢å™¨</span>
</span></span><span class=line><span class=cl>    <span class=n>retriever</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(</span><span class=n>search_type</span><span class=o>=</span><span class=s2>&#34;similarity&#34;</span><span class=p>,</span> <span class=n>search_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;k&#34;</span><span class=p>:</span> <span class=n>k</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤10åˆ›å»ºå¯¹è¯æ£€ç´¢é“¾ç”¨äºå°†èŠå¤©å†å²å’Œæ–°æçš„é—®é¢˜æ•´åˆæˆä¸€ä¸ªæ–°çš„ç‹¬ç«‹é—®é¢˜>æ­¥éª¤10ï¼šåˆ›å»ºå¯¹è¯æ£€ç´¢é“¾ï¼Œç”¨äºå°†èŠå¤©å†å²å’Œæ–°æçš„é—®é¢˜æ•´åˆæˆä¸€ä¸ªæ–°çš„ç‹¬ç«‹é—®é¢˜</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_db</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>chain_type</span><span class=p>,</span> <span class=n>k</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># create a chatbot chain. Memory is managed externally.</span>
</span></span><span class=line><span class=cl>    <span class=n>qa</span> <span class=o>=</span> <span class=n>ConversationalRetrievalChain</span><span class=o>.</span><span class=n>from_llm</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>llm</span><span class=o>=</span><span class=n>ChatOpenAI</span><span class=p>(</span><span class=n>model_name</span><span class=o>=</span><span class=n>llm_name</span><span class=p>,</span> <span class=n>temperature</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>        <span class=n>chain_type</span><span class=o>=</span><span class=n>chain_type</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=n>retriever</span><span class=o>=</span><span class=n>retriever</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=n>return_source_documents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>return_generated_question</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>qa</span> 
</span></span></code></pre></td></tr></table></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¼ å…¥è®°å¿†ç³»ç»Ÿï¼Œè€Œæ˜¯å°†è®°å¿†ç®¡ç†äº¤ç»™äº†GUIï¼Œè¿™æ„å‘³ç€èŠå¤©å†å²éœ€è¦åœ¨é“¾ä¹‹å¤–è¿›è¡Œç»´æŠ¤ã€‚</p><h3 id=æ­¥éª¤11æä¾›ä¸€ä¸ªä¸èŠå¤©æœºå™¨äººäº¤äº’çš„ç”¨æˆ·ç•Œé¢>æ­¥éª¤11ï¼šæä¾›ä¸€ä¸ªä¸èŠå¤©æœºå™¨äººäº¤äº’çš„ç”¨æˆ·ç•Œé¢</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>panel</span> <span class=k>as</span> <span class=nn>pn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>param</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>cbfs</span><span class=p>(</span><span class=n>param</span><span class=o>.</span><span class=n>Parameterized</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>chat_history</span> <span class=o>=</span> <span class=n>param</span><span class=o>.</span><span class=n>List</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>    <span class=n>answer</span> <span class=o>=</span> <span class=n>param</span><span class=o>.</span><span class=n>String</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db_query</span>  <span class=o>=</span> <span class=n>param</span><span class=o>.</span><span class=n>String</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db_response</span> <span class=o>=</span> <span class=n>param</span><span class=o>.</span><span class=n>List</span><span class=p>([])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>  <span class=o>**</span><span class=n>params</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>cbfs</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span> <span class=o>**</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>panels</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>loaded_file</span> <span class=o>=</span> <span class=s2>&#34;docs/cs229_lectures/MachineLearning-Lecture01.pdf&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>qa</span> <span class=o>=</span> <span class=n>load_db</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>loaded_file</span><span class=p>,</span><span class=s2>&#34;stuff&#34;</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>call_load_db</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>count</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>count</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>file_input</span><span class=o>.</span><span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  <span class=c1># init or no file specified :</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Loaded File: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>loaded_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>file_input</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>&#34;temp.pdf&#34;</span><span class=p>)</span>  <span class=c1># local copy</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>loaded_file</span> <span class=o>=</span> <span class=n>file_input</span><span class=o>.</span><span class=n>filename</span>
</span></span><span class=line><span class=cl>            <span class=n>button_load</span><span class=o>.</span><span class=n>button_style</span><span class=o>=</span><span class=s2>&#34;outline&#34;</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>qa</span> <span class=o>=</span> <span class=n>load_db</span><span class=p>(</span><span class=s2>&#34;temp.pdf&#34;</span><span class=p>,</span> <span class=s2>&#34;stuff&#34;</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>button_load</span><span class=o>.</span><span class=n>button_style</span><span class=o>=</span><span class=s2>&#34;solid&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>clr_history</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Loaded File: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>loaded_file</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>convchain</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>query</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>WidgetBox</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=s1>&#39;User:&#39;</span><span class=p>,</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>)),</span> <span class=n>scroll</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>qa</span><span class=p>({</span><span class=s2>&#34;question&#34;</span><span class=p>:</span> <span class=n>query</span><span class=p>,</span> <span class=s2>&#34;chat_history&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>chat_history</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>chat_history</span><span class=o>.</span><span class=n>extend</span><span class=p>([(</span><span class=n>query</span><span class=p>,</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;answer&#34;</span><span class=p>])])</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_query</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;generated_question&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_response</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s2>&#34;source_documents&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>answer</span> <span class=o>=</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;answer&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>panels</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
</span></span><span class=line><span class=cl>            <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=s1>&#39;User:&#39;</span><span class=p>,</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=s1>&#39;ChatBot:&#39;</span><span class=p>,</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>answer</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>style</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;#F6F6F6&#39;</span><span class=p>}))</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>inp</span><span class=o>.</span><span class=n>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>  <span class=c1>#clears loading indicator when cleared</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>WidgetBox</span><span class=p>(</span><span class=o>*</span><span class=bp>self</span><span class=o>.</span><span class=n>panels</span><span class=p>,</span><span class=n>scroll</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@param.depends</span><span class=p>(</span><span class=s1>&#39;db_query &#39;</span><span class=p>,</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_lquest</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>db_query</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Last question to DB:&#34;</span><span class=p>,</span> <span class=n>styles</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;#F6F6F6&#39;</span><span class=p>})),</span>
</span></span><span class=line><span class=cl>                <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Str</span><span class=p>(</span><span class=s2>&#34;no DB accesses so far&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;DB query:&#34;</span><span class=p>,</span> <span class=n>styles</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;#F6F6F6&#39;</span><span class=p>})),</span>
</span></span><span class=line><span class=cl>            <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Str</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>db_query</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@param.depends</span><span class=p>(</span><span class=s1>&#39;db_response&#39;</span><span class=p>,</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_sources</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>db_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> 
</span></span><span class=line><span class=cl>        <span class=n>rlist</span><span class=o>=</span><span class=p>[</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Result of DB lookup:&#34;</span><span class=p>,</span> <span class=n>styles</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;#F6F6F6&#39;</span><span class=p>}))]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>db_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>rlist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Str</span><span class=p>(</span><span class=n>doc</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>WidgetBox</span><span class=p>(</span><span class=o>*</span><span class=n>rlist</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>scroll</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@param.depends</span><span class=p>(</span><span class=s1>&#39;convchain&#39;</span><span class=p>,</span> <span class=s1>&#39;clr_history&#39;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_chats</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>chat_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>WidgetBox</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Str</span><span class=p>(</span><span class=s2>&#34;No History Yet&#34;</span><span class=p>)),</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>scroll</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>rlist</span><span class=o>=</span><span class=p>[</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Current Chat History variable&#34;</span><span class=p>,</span> <span class=n>styles</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;background-color&#39;</span><span class=p>:</span> <span class=s1>&#39;#F6F6F6&#39;</span><span class=p>}))]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>exchange</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>chat_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>rlist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Str</span><span class=p>(</span><span class=n>exchange</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>pn</span><span class=o>.</span><span class=n>WidgetBox</span><span class=p>(</span><span class=o>*</span><span class=n>rlist</span><span class=p>,</span> <span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>scroll</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>clr_history</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>count</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>chat_history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> 
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cb</span> <span class=o>=</span> <span class=n>cbfs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>file_input</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>widgets</span><span class=o>.</span><span class=n>FileInput</span><span class=p>(</span><span class=n>accept</span><span class=o>=</span><span class=s1>&#39;.pdf&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>button_load</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>widgets</span><span class=o>.</span><span class=n>Button</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;Load DB&#34;</span><span class=p>,</span> <span class=n>button_type</span><span class=o>=</span><span class=s1>&#39;primary&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>button_clearhistory</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>widgets</span><span class=o>.</span><span class=n>Button</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;Clear History&#34;</span><span class=p>,</span> <span class=n>button_type</span><span class=o>=</span><span class=s1>&#39;warning&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>button_clearhistory</span><span class=o>.</span><span class=n>on_click</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>clr_history</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>inp</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>widgets</span><span class=o>.</span><span class=n>TextInput</span><span class=p>(</span> <span class=n>placeholder</span><span class=o>=</span><span class=s1>&#39;Enter text hereâ€¦&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bound_button_load</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>bind</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>call_load_db</span><span class=p>,</span> <span class=n>button_load</span><span class=o>.</span><span class=n>param</span><span class=o>.</span><span class=n>clicks</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>conversation</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>bind</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>convchain</span><span class=p>,</span> <span class=n>inp</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>jpg_pane</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Image</span><span class=p>(</span> <span class=s1>&#39;./img/convchain.jpg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tab1</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>inp</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>layout</span><span class=o>.</span><span class=n>Divider</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>panel</span><span class=p>(</span><span class=n>conversation</span><span class=p>,</span>  <span class=n>loading_indicator</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=mi>300</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>layout</span><span class=o>.</span><span class=n>Divider</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tab2</span><span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>panel</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>get_lquest</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>layout</span><span class=o>.</span><span class=n>Divider</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>panel</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>get_sources</span> <span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tab3</span><span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>panel</span><span class=p>(</span><span class=n>cb</span><span class=o>.</span><span class=n>get_chats</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>layout</span><span class=o>.</span><span class=n>Divider</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tab4</span><span class=o>=</span><span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span> <span class=n>file_input</span><span class=p>,</span> <span class=n>button_load</span><span class=p>,</span> <span class=n>bound_button_load</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span> <span class=n>button_clearhistory</span><span class=p>,</span> <span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=s2>&#34;Clears chat history. Can use to start a new topic&#34;</span> <span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>layout</span><span class=o>.</span><span class=n>Divider</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>jpg_pane</span><span class=o>.</span><span class=n>clone</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>400</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dashboard</span> <span class=o>=</span> <span class=n>pn</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Row</span><span class=p>(</span><span class=n>pn</span><span class=o>.</span><span class=n>pane</span><span class=o>.</span><span class=n>Markdown</span><span class=p>(</span><span class=s1>&#39;# ChatWithYourData_Bot&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=n>pn</span><span class=o>.</span><span class=n>Tabs</span><span class=p>((</span><span class=s1>&#39;Conversation&#39;</span><span class=p>,</span> <span class=n>tab1</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Database&#39;</span><span class=p>,</span> <span class=n>tab2</span><span class=p>),</span> <span class=p>(</span><span class=s1>&#39;Chat History&#39;</span><span class=p>,</span> <span class=n>tab3</span><span class=p>),(</span><span class=s1>&#39;Configure&#39;</span><span class=p>,</span> <span class=n>tab4</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dashboard</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ­¥éª¤12åœ¨è¿è¡Œèµ·æ¥çš„ç”¨æˆ·ç•Œé¢ä¸Šè¿›è¡Œå®é™…çš„é—®ç­”å¯¹è¯>æ­¥éª¤12ï¼šåœ¨è¿è¡Œèµ·æ¥çš„ç”¨æˆ·ç•Œé¢ä¸Šè¿›è¡Œå®é™…çš„é—®ç­”å¯¹è¯ã€‚</h3></section><footer class=article-footer><section class=article-tags><a href=/tags/langchain/>LangChain</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/ii-%E5%9F%BA%E4%BA%8Elangchain%E7%9A%84%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E4%B8%8B/><div class=article-details><h2 class=article-title>II: åŸºäºLangChainçš„å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘(ä¸‹)</h2></div></a></article><article><a href=/p/i-%E5%9F%BA%E4%BA%8Elangchain%E7%9A%84%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E4%B8%8A/><div class=article-details><h2 class=article-title>I: åŸºäºLangChainçš„å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘(ä¸Š)</h2></div></a></article><article><a href=/p/i-%E5%90%91%E9%87%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E9%89%B4%E8%B5%8F/><div class=article-details><h2 class=article-title>I: å‘é‡æ•°æ®åº“æŠ€æœ¯é‰´èµ</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 importzhhçš„å°ç ´ç«™</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>