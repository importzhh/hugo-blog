<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="运输层概述 概念 进程之间的通信 从通信和信息处理的角度看，运输层向它上面的应用层提供通信服务，它属于面向通信部分的最高层，同时也是用户功能中的最"><title>V: 计算机网络微课堂-运输层</title><link rel=canonical href=https://blog.importzhh.me/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/><link rel=stylesheet href=/scss/style.min.0d8902b26558cddb5286ea49f2a7aadd5761ed898547e29e5ab572d8c0619ba6.css><meta property="og:title" content="V: 计算机网络微课堂-运输层"><meta property="og:description" content="运输层概述 概念 进程之间的通信 从通信和信息处理的角度看，运输层向它上面的应用层提供通信服务，它属于面向通信部分的最高层，同时也是用户功能中的最"><meta property="og:url" content="https://blog.importzhh.me/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/"><meta property="og:site_name" content="importzhh的小破站"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="计算机网络微课堂笔记"><meta property="article:published_time" content="2023-07-15T12:44:47+08:00"><meta property="article:modified_time" content="2023-07-15T12:44:47+08:00"><meta name=twitter:title content="V: 计算机网络微课堂-运输层"><meta name=twitter:description content="运输层概述 概念 进程之间的通信 从通信和信息处理的角度看，运输层向它上面的应用层提供通信服务，它属于面向通信部分的最高层，同时也是用户功能中的最"><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_huce6e906a97de2553354850eae15a0392_8624_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>importzhh的小破站</a></h1><h2 class=site-description>实事求是 思危思退思变</h2></div></header><ol class=social-menu><li><a href=https://github.com/importzhh target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="-1.65 0 259.3 259.3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid"><g><path fill="#9edcf2" d="M200.9 199.8c0 13.9-32.2 25.1-71.9 25.1-39.7.0-71.9-11.3-71.9-25.1.0-13.9 32.2-25.1 71.9-25.1C168.7 174.7 200.9 185.9 200.9 199.8zm0 0"/><g><defs><path id="SVGID_1_" d="M98.1 244.8c1.6 7.5 5.5 11.9 9.4 14.5h41.1c5-3.4 10.1-9.8 10.1-21.8v-31s.6-7.7 7.7-10.2c0 0 4.1-2.9-.3-4.5.0.0-19.5-1.6-19.5 14.4v23.6s.8 8.7-3.8 12.3v-29.2s.3-9.3 5.1-12.8c0 0 3.2-5.7-3.8-4.2.0.0-13.4 1.9-14 17.6l-.3 30h-3.2l-.3-30c-.6-15.6-14-17.6-14-17.6-7-1.6-3.8 4.2-3.8 4.2 4.8 3.5 5.1 12.8 5.1 12.8v29.5c-4.6-3.3-3.8-12.6-3.8-12.6v-23.6c0-16-19.5-14.4-19.5-14.4-4.5 1.6-.3 4.5-.3 4.5 7 2.6 7.7 10.2 7.7 10.2v21.7L98.1 244.8z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><path clip-path="url(#SVGID_2_)" fill="#7dbce7" d="M200.9 199.8c0 13.9-32.2 25.1-71.9 25.1-39.7.0-71.9-11.3-71.9-25.1.0-13.9 32.2-25.1 71.9-25.1C168.7 174.7 200.9 185.9 200.9 199.8zm0 0"/></g><path fill="#9edcf2" d="M46.9 125.9l-2.1 7.2s-.5 2.6 1.9 3.1c2.6-.1 2.4-2.5 2.2-3.2L46.9 125.9zm0 0"/><path fill="#010101" d="M255.8 95.6l.2-.9c-21.1-4.2-42.7-4.3-55.8-3.7 2.1-7.7 2.8-16.7 2.8-26.6.0-14.3-5.4-25.7-14-34.3 1.5-4.9 3.5-15.8-2-29.7.0.0-9.8-3.1-32.1 11.8-8.7-2.2-18-3.3-27.3-3.3-10.2.0-20.5 1.3-30.2 3.9C74.4-2.9 64.3.3 64.3.3c-6.6 16.5-2.5 28.8-1.3 31.8-7.8 8.4-12.5 19.1-12.5 32.2.0 9.9 1.1 18.8 3.9 26.5-13.2-.5-34-.3-54.4 3.8l.2.9c20.4-4.1 41.4-4.2 54.5-3.7.6 1.6 1.3 3.2 2 4.7-13 .4-35.1 2.1-56.3 8.1l.3.9c21.4-6 43.7-7.6 56.6-8 7.8 14.4 23 23.8 50.2 26.7-3.9 2.6-7.8 7-9.4 14.5-5.3 2.5-21.9 8.7-31.9-8.5.0.0-5.6-10.2-16.3-11 0 0-10.4-.2-.7 6.5.0.0 6.9 3.3 11.7 15.6.0.0 6.3 21 36.4 14.2V177s-.6 7.7-7.7 10.2c0 0-4.2 2.9.3 4.5.0.0 19.5 1.6 19.5-14.4v-23.6s-.8-9.4 3.8-12.6v38.8s-.3 9.3-5.1 12.8c0 0-3.2 5.7 3.8 4.2.0.0 13.4-1.9 14-17.6l.3-39.3h3.2l.3 39.3c.6 15.6 14 17.6 14 17.6 7 1.6 3.8-4.2 3.8-4.2-4.8-3.5-5.1-12.8-5.1-12.8v-38.5c4.6 3.6 3.8 12.3 3.8 12.3v23.6c0 16 19.5 14.4 19.5 14.4 4.5-1.6.3-4.5.3-4.5-7-2.6-7.7-10.2-7.7-10.2v-31c0-12.1-5.1-18.5-10.1-21.8 29-2.9 42.9-12.2 49.3-26.8 12.7.3 35.6 1.9 57.4 8.1l.3-.9c-21.7-6.1-44.4-7.7-57.3-8.1.6-1.5 1.1-3 1.6-4.6C212.9 91.4 234.6 91.4 255.8 95.6zm0 0"/><path fill="#f5ccb3" d="M174.6 63.7c6.2 5.7 9.9 12.5 9.9 19.8.0 34.4-25.6 35.3-57.2 35.3S70.1 114 70.1 83.5c0-7.3 3.6-14.1 9.8-19.7 10.3-9.4 27.7-4.4 47.4-4.4 19.7.0 37-5.1 47.3 4.3zm0 0"/><path fill="#fff" d="M108.3 85.3c0 9.5-5.3 17.1-11.9 17.1-6.6.0-11.9-7.7-11.9-17.1.0-9.5 5.3-17.1 11.9-17.1C103 68.1 108.3 75.8 108.3 85.3zm0 0"/><path fill="#af5c51" d="M104.5 85.5c0 6.3-3.6 11.4-7.9 11.4-4.4.0-7.9-5.1-7.9-11.4.0-6.3 3.6-11.4 7.9-11.4S104.5 79.2 104.5 85.5zm0 0"/><path fill="#fff" d="M172.2 85.3c0 9.5-5.3 17.1-11.9 17.1s-11.9-7.7-11.9-17.1c0-9.5 5.3-17.1 11.9-17.1C166.8 68.1 172.2 75.8 172.2 85.3zm0 0"/><path fill="#af5c51" d="M168.3 85.5c0 6.3-3.6 11.4-7.9 11.4-4.4.0-7.9-5.1-7.9-11.4.0-6.3 3.6-11.4 7.9-11.4C164.8 74.1 168.3 79.2 168.3 85.5zm0 0"/><path fill="#af5c51" d="M130.5 100.5c0 1.6-1.3 3-3 3-1.6.0-3-1.3-3-3s1.3-3 3-3c1.59999999999999.0 3 1.3 3 3zm0 0"/><path fill="#af5c51" d="M120.6 108c-.2-.5.1-1 .6-1.2s1 .1 1.2.6c.8 2.2 2.8 3.6 5.1 3.6s4.3-1.5 5.1-3.6c.2-.5.7-.8 1.2-.6s.8.7.6 1.2c-1 2.9-3.8 4.9-6.9 4.9C124.4 112.9 121.6 110.9 120.6 108zm0 0"/><path fill="#c4e5d9" d="M54.5 121.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4.0-.8.9-1.4 2.1-1.4C53.6 120.2 54.5 120.8 54.5 121.6zm0 0"/><path fill="#c4e5d9" d="M60.3 124.8c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4.0-.8.9-1.4 2.1-1.4C59.4 123.4 60.3 124 60.3 124.8zm0 0"/><path fill="#c4e5d9" d="M63.8 129c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C62.9 127.5 63.8 128.2 63.8 129zm0 0"/><path fill="#c4e5d9" d="M67 133.8c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C66.1 132.3 67 133 67 133.8zm0 0"/><path fill="#c4e5d9" d="M70.5 138.2c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C69.6 136.8 70.5 137.4 70.5 138.2zm0 0"/><path fill="#c4e5d9" d="M75.3 142.1c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C74.4 140.6 75.3 141.3 75.3 142.1zm0 0"/><path fill="#c4e5d9" d="M82 144.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4S82 143.8 82 144.6zm0 0"/><path fill="#c4e5d9" d="M88.7 144.6c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4S88.7 143.8 88.7 144.6zm0 0"/><path fill="#c4e5d9" d="M95.5 143.5c0 .8-.9 1.4-2.1 1.4-1.1.0-2.1-.6-2.1-1.4s.9-1.4 2.1-1.4C94.5 142.1 95.5 142.7 95.5 143.5zm0 0"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#运输层概述>运输层概述</a><ol><li><a href=#概念>概念</a></li><li><a href=#总结>总结</a></li></ol></li><li><a href=#运输层端口号复用与分用的概念>运输层端口号、复用与分用的概念</a><ol><li><a href=#为什么用端口号>为什么用端口号</a></li><li><a href=#发送方的复用和接收方的分用>发送方的复用和接收方的分用</a></li><li><a href=#tcpip体系的应用层常用协议所使用的运输层熟知端口号>TCP/IP体系的应用层常用协议所使用的运输层熟知端口号</a></li><li><a href=#运输层传输流程>运输层传输流程</a></li></ol></li><li><a href=#udp和tcp的对比>UDP和TCP的对比</a><ol><li><a href=#概念-1>概念</a></li><li><a href=#用户数据报协议udpuser-datagram-protocol>用户数据报协议UDP（User Datagram Protocol）</a></li><li><a href=#传输控制协议tcptransmission-control-protocol>传输控制协议TCP（Transmission Control Protocol）</a></li><li><a href=#总结-1>总结</a></li></ol></li><li><a href=#tcp的流量控制>TCP的流量控制</a><ol><li><a href=#概念-2>概念</a></li><li><a href=#总结-2>总结</a></li></ol></li><li><a href=#tcp的拥塞控制>TCP的拥塞控制</a><ol><li><a href=#概念-3>概念</a></li><li><a href=#拥塞控制的算法>拥塞控制的算法</a><ol><li><a href=#慢开始和拥塞避免>慢开始和拥塞避免</a></li><li><a href=#快重传和快恢复>快重传和快恢复</a></li></ol></li></ol></li><li><a href=#tcp超时重传时间的选择>TCP超时重传时间的选择</a></li><li><a href=#tcp可靠传输的实现>TCP可靠传输的实现</a></li><li><a href=#tcp的运输连接管理>TCP的运输连接管理</a><ol><li><a href=#概念-4>概念</a></li><li><a href=#tcp的连接建立>TCP的连接建立</a><ol><li><a href=#tcp的连接建立要解决以下三个问题>TCP的连接建立要解决以下三个问题</a></li><li><a href=#tcp使用三报文握手建立连接>TCP使用“三报文握手”建立连接</a></li><li><a href=#总结-3>总结</a></li></ol></li><li><a href=#tcp的连接释放>TCP的连接释放</a><ol><li><a href=#tcp通过四报文挥手来释放连接>TCP通过“四报文挥手”来释放连接</a></li><li><a href=#tcp保活计时器的作用>TCP保活计时器的作用</a></li></ol></li></ol></li><li><a href=#tcp报文段的首部格式>TCP报文段的首部格式</a><ol><li><a href=#各字段的作用>各字段的作用</a></li></ol></li><li><a href=#习题>习题</a><ol><li><a href=#tcp的流量控制-1>TCP的流量控制</a></li><li><a href=#tcp的拥塞控制-1>TCP的拥塞控制</a></li><li><a href=#tcp可靠传输的实现-1>TCP可靠传输的实现</a></li><li><a href=#tcp的运输连接管理-1>TCP的运输连接管理</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/>计算机网络</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/>V: 计算机网络微课堂-运输层</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jul 15, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 15 分钟</time></div></footer></div></header><section class=article-content><h2 id=运输层概述>运输层概述</h2><h3 id=概念>概念</h3><p><strong>进程之间的通信</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211725185.png width=607 height=347 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211725185_hua89f9cdd919900b672005fdaee828bab_22235_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211725185_hua89f9cdd919900b672005fdaee828bab_22235_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=174 data-flex-basis=419px></p><ul><li>从通信和信息处理的角度看，运输层向它上面的应用层提供通信服务，<strong>它属于面向通信部分的最高层，同时也是用户功能中的最低层</strong>。</li><li>当网络的边缘部分中的两个主机使用网络的核心部分的功能进行端到端的通信时，<strong>只有位于网络边缘部分的主机的协议栈才有运输层</strong>，而网络核心部分中的路由器在转发分组时都只用到三层（到网络层）的功能。</li></ul><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211339131.png width=1870 height=718 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211339131_hu27c2ecf15d3c5fc3adb91d976035283e_590902_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020211339131_hu27c2ecf15d3c5fc3adb91d976035283e_590902_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=260 data-flex-basis=625px></p><p><strong>进程之间通信流程</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020213721054.png width=1879 height=966 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020213721054_hue278eced8d8d7efaaa9fc4c22744f299_762481_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020213721054_hue278eced8d8d7efaaa9fc4c22744f299_762481_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=194 data-flex-basis=466px></p><p>“逻辑通信”是指运输层之间的通信好像是沿水平方向传送数据，但事实上，这两条数据并没有一条水平方向的物理连接，要传送的数据是沿着图中上下多次的虚线方向传送的</p><blockquote><p>进程Ap1与Ap4之间进行基于网络的通信，进程Ap2与Ap3之间进行基于网络的通信</p><p>在运输层使用不同的端口，来对应不同的应用进程</p><p>然后通过网络层及其下层来传输应用层报文</p><p>接收方的运输层通过不同的端口，将收到的应用层报文，交付给应用层中相应的应用进程</p><p>这里端口并不是指看得见、摸得着的物理端口，而是指用来区分不同应用进程的标识符</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220439303.png width=1844 height=346 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220439303_hu35f2cbc4381b0cf80865a9937aafb4c1_448832_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220439303_hu35f2cbc4381b0cf80865a9937aafb4c1_448832_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=532 data-flex-basis=1279px></p><h3 id=总结>总结</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220545411.png width=1475 height=706 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220545411_hu79de87e2bfbb828f602c013bb7116569_732069_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020220545411_hu79de87e2bfbb828f602c013bb7116569_732069_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=208 data-flex-basis=501px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020222828878.png width=951 height=374 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020222828878_hu90395f2d586a060b0ad529df2a3369ed_51456_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020222828878_hu90395f2d586a060b0ad529df2a3369ed_51456_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=254 data-flex-basis=610px></p><hr><h2 id=运输层端口号复用与分用的概念>运输层端口号、复用与分用的概念</h2><h3 id=为什么用端口号>为什么用端口号</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223242364.png width=1647 height=846 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223242364_hube0e638b393ed4bea50254f00c89402f_851606_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223242364_hube0e638b393ed4bea50254f00c89402f_851606_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=194 data-flex-basis=467px></p><h3 id=发送方的复用和接收方的分用>发送方的复用和接收方的分用</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223920225.png width=1869 height=710 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223920225_hu05e18a053606ceaef9b4ae9242bd2080_443366_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020223920225_hu05e18a053606ceaef9b4ae9242bd2080_443366_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=263 data-flex-basis=631px></p><blockquote><p><strong>多个进程（这里一个端口表示一个进程）</strong> 利用一个运输层协议（或者称为运输层接口）<strong>发送</strong>数据称为 <strong>复用</strong></p><p><strong>多个进程（这里一个端口表示一个进程）</strong> 利用一个运输层协议（或者称为运输层接口）<strong>接收</strong>时叫做 <strong>分用</strong>。</p></blockquote><h3 id=tcpip体系的应用层常用协议所使用的运输层熟知端口号>TCP/IP体系的应用层常用协议所使用的运输层熟知端口号</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224521744.png width=1902 height=755 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224521744_hu9f9cf45d4ba59592752676b89184c486_359956_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224521744_hu9f9cf45d4ba59592752676b89184c486_359956_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=251 data-flex-basis=604px></p><h3 id=运输层传输流程>运输层传输流程</h3><p>举例</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224658524.png width=1912 height=838 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224658524_hue8caab5ac1a4c8d7aa0486967d58fb50_323394_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020224658524_hue8caab5ac1a4c8d7aa0486967d58fb50_323394_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=228 data-flex-basis=547px></p><blockquote><p>在浏览器输入域名，回车浏览</p><p>然后用户PC中的DNS客户端进程会发送一个DNS查询请求报文</p><p>DNS查询请求报文需要使用运输层的UDP协议</p><p>首部中的源端口字段的值，在短暂端口号49151~65535中挑选一个未被占用的，用来表示DNS客户端进程</p><p>首部中的目的端口字段的值：53，是DNS服务器端进程所使用的熟知端口号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020225830336.png width=1763 height=767 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020225830336_hu555eeb3e07baef8e5c30edb13f52f2bc_229440_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020225830336_hu555eeb3e07baef8e5c30edb13f52f2bc_229440_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=229 data-flex-basis=551px></p><blockquote><p>之后，将UDP用户数据报封装在IP数据报中，通过以太网发送给DNS服务器</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020230059196.png width=1823 height=843 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020230059196_hu1d11a46ad50b7e28fc5fdde21a68bfba_337178_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020230059196_hu1d11a46ad50b7e28fc5fdde21a68bfba_337178_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=216 data-flex-basis=519px></p><blockquote><p>DNS服务器收到该IP数据报后，从中解封出UDP用户数据报</p><p>UDP首部中的目的端口号为53，这表明应将该UDP用户数据报的数据载荷部分，也就是DNS查询请求报文，交付给本服务器中的DNS服务器端进程</p><p>DNS服务器端进程解析DNS查询请求报文的内容，然后按其要求查找对应的IP地址</p><p>之后，会给用户PC发送DNS响应报文，DNS响应报文需要使用运输层的UDP协议封装成UDP用户数据报</p><p>其首部中的源端口字段的值设置为熟知端口号53，表明这是DNS服务器端进程所发送的UDP用户数据报，目的端口的值设置为49152，这是之前用户PC中发送DNS查询请求报文的DNS客户端进程所使用的短暂端口号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231032812.png width=1870 height=840 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231032812_hu7643393921e35305ce733f1641cd89bf_236600_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231032812_hu7643393921e35305ce733f1641cd89bf_236600_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=222 data-flex-basis=534px></p><blockquote><p>将UDP用户数据报封装在IP数据报中，通过以太网发送给用户PC</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231308120.png width=1893 height=829 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231308120_huf492b97e16ce80c74e17fb61e0f6dd33_288559_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231308120_huf492b97e16ce80c74e17fb61e0f6dd33_288559_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=228 data-flex-basis=548px></p><blockquote><p>用户PC收到该数据报后，从中解封出UDP用户数据报</p><p>UDP首部中的目的端口号为49152，这表明应将该UDP用户数据报的数据载荷部分，也就是DNS响应报文，交付给用户PC中的DNS客户端进程</p><p>DNS客户端进程解析DNS响应报文的内容，就可知道自己之前所请求的Web服务器的域名对应的IP地址</p></blockquote><p>现在用户PC中的HTTP客户端进程可以向Web服务器发送HTTP请求报文（和DNS发送和接收流程差不多）</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231935656.png width=1904 height=838 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231935656_huc520260d4559f23358e8ca0a44a7b45e_298778_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020231935656_huc520260d4559f23358e8ca0a44a7b45e_298778_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=227 data-flex-basis=545px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232517383.png width=1800 height=839 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232517383_huca2e8f9b2e8cce9aed977bce7196100f_233211_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232517383_huca2e8f9b2e8cce9aed977bce7196100f_233211_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=214 data-flex-basis=514px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232132890.png width=1893 height=890 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232132890_hudab79620f8507ec14318adf774124d16_320382_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232132890_hudab79620f8507ec14318adf774124d16_320382_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=212 data-flex-basis=510px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232548833.png width=1805 height=897 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232548833_hudd34cdfa9a735fbb9f191e2e085a91ff_244568_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232548833_hudd34cdfa9a735fbb9f191e2e085a91ff_244568_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=201 data-flex-basis=482px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232337332.png width=1900 height=846 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232337332_hu8046f0d9dcc72d5478f8838d4f5f893b_270317_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201020232337332_hu8046f0d9dcc72d5478f8838d4f5f893b_270317_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=224 data-flex-basis=539px></p><hr><h2 id=udp和tcp的对比>UDP和TCP的对比</h2><h3 id=概念-1>概念</h3><ul><li><strong>UDP</strong> 和 <strong>TCP</strong> 是TCP/IP体系结构<strong>运输层</strong>中的两个重要协议</li><li>当运输层采用面向连接的 <strong>TCP</strong> 协议时，尽管下面的网络是不可靠的（只提供尽最大努力服务），但这种逻辑通信信道就相当于一条<strong>全双工的可靠信道</strong>。</li><li>当运输层采用无连接的 <strong>UDP</strong> 协议时，这种逻辑通信信道是一条<strong>不可靠信道</strong>。</li></ul><p>可靠信道与不可靠信道</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021192221061.png width=909 height=422 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021192221061_hub4b173e146b394a1ea38fc4ebb81133e_44989_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021192221061_hub4b173e146b394a1ea38fc4ebb81133e_44989_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=215 data-flex-basis=516px></p><ul><li><p>两个对等运输实体在通信时传送的数据单位叫作<strong>运输协议数据单元</strong> TPDU (Transport Protocol Data Unit)。</p></li><li><p>TCP 传送的数据单位协议是 <strong>TCP 报文段</strong>(segment)。</p></li><li><p>UDP 传送的数据单位协议是 <strong>UDP 报文</strong>或<strong>用户数据报</strong>。</p></li></ul><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021193640130.png width=1215 height=1086 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021193640130_hue9a859297ca1c9fab19f19d0bc5b1fe5_391544_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021193640130_hue9a859297ca1c9fab19f19d0bc5b1fe5_391544_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=111 data-flex-basis=268px></p><p>UDP的通信是无连接的，不需要套接字（Socket）</p><p>TCP是面向连接的，TCP之间的通信必须要在两个套接字（Socket）之间建立连接</p><h3 id=用户数据报协议udpuser-datagram-protocol>用户数据报协议UDP（User Datagram Protocol）</h3><p>可以发送广播</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194104694.png width=937 height=695 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194104694_hue0c0052ff0b3159580db1cfb2eb3bd98_172260_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194104694_hue0c0052ff0b3159580db1cfb2eb3bd98_172260_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=134 data-flex-basis=323px></p><p>可以向某个多播组发送多播</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194225567.png width=983 height=729 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194225567_hu759b4dda2e08b2732917a110f69c8bb8_193151_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194225567_hu759b4dda2e08b2732917a110f69c8bb8_193151_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=134 data-flex-basis=323px></p><p>还可以发送单播</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194341256.png width=914 height=686 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194341256_hu1b04981e17cf8ad464aee501aaf9dc8d_141435_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194341256_hu1b04981e17cf8ad464aee501aaf9dc8d_141435_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=133 data-flex-basis=319px></p><blockquote><p>UDP 支持单播、多播以及广播</p><p>换句话说，UDP支持一对一，一对多，以及一对全的通信</p></blockquote><p>运输过程</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195034383.png width=949 height=757 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195034383_hufa2a2f107e9955198f3024f2f7133776_267848_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195034383_hufa2a2f107e9955198f3024f2f7133776_267848_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=125 data-flex-basis=300px></p><blockquote><p>UDP对应用进程交下来的报文既不合并也不拆分，而是保留这些报文的边界</p><p>换句话说，UDP是面向应用报文的</p></blockquote><p>UDP向上层提供无连接不可靠传输服务</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204152175.png width=970 height=730 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204152175_hu047956784e25230ef545a2dc37333187_430273_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204152175_hu047956784e25230ef545a2dc37333187_430273_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=132 data-flex-basis=318px></p><p>UDP结构</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205214512.png width=871 height=451 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205214512_hu205096e9130b87bebf6d7569d10ca2a6_153397_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205214512_hu205096e9130b87bebf6d7569d10ca2a6_153397_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=193 data-flex-basis=463px></p><h3 id=传输控制协议tcptransmission-control-protocol>传输控制协议TCP（Transmission Control Protocol）</h3><p>使用TCP协议的通信双方，在进行数据传输之前，必须使用“三报文握手”建立TCP连接</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194557102.png width=920 height=666 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194557102_hu4cc5c9098ed0a0089158cfa89284bdf2_161490_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194557102_hu4cc5c9098ed0a0089158cfa89284bdf2_161490_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=138 data-flex-basis=331px></p><p>TCP连接建立成功后，通信双方之间就好像有一条可靠的通信信道，通信双方使用这条基于TCP连接的可靠信道进行通信</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194749562.png width=932 height=665 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194749562_hu2e93a757c309f6de9b50649a74cb4d04_139752_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021194749562_hu2e93a757c309f6de9b50649a74cb4d04_139752_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=140 data-flex-basis=336px></p><blockquote><p>很显然，TCP仅支持单播，也就是一对一的通信</p></blockquote><p>运输过程</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195435677.png width=951 height=760 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195435677_huda88d1f986edc95cdba6f4eeff33c637_235094_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021195435677_huda88d1f986edc95cdba6f4eeff33c637_235094_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=125 data-flex-basis=300px></p><blockquote><p>发送方</p><ul><li><p>TCP会把应用进程交付下来的数据块看作是一连串无结构的字节流，TCP并不知道这些待传送的字节流的含义</p></li><li><p>并将他们编号，并存储在自己发送缓存中</p></li><li><p>TCP会根据发送策略，提取一定量的字节构建TCP报文并发送</p></li></ul><p>接收方</p><ul><li>一方面从所接受到的TCP报文段中，取出数据载荷部分并存储在接收缓存中；一方面将接收缓存中的一些字节交付给应用进程</li><li>TCP不保证接收方应用进程所收到的数据块与发送方发送的数据块，具有对应大小的关系（例如，发送方应用进程交给发送方的TCP共10个数据块，但接收方的TCP可能只用了4个数据块，就把收到的字节流交付给了上层的应用进程，但接收方收到的字节流必须和发送方应用进程发出的字节流完全一样）</li><li>接收方的应用进程必须有能力识别收到的字节流，把它还原成有意义的应用层数据</li></ul><p>TCP是面向字节流的，这正是TCP实现可靠传输、流量控制、以及拥塞控制的基础</p><p>本图只画了一个方向的数据流，在实际网络中，基于TCP连接的两端，可以同时进行TCP报文段的发送和接收</p></blockquote><p>TCP向上层提供面向连接的可靠传输服务</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204508839.png width=932 height=746 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204508839_huc104b0f68f3c3ad49e41b92db8e00279_479191_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021204508839_huc104b0f68f3c3ad49e41b92db8e00279_479191_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=124 data-flex-basis=299px></p><p>TCP结构</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205307406.png width=897 height=680 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205307406_hu6bd57d353f76bf8ca205b730a0917293_270164_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021205307406_hu6bd57d353f76bf8ca205b730a0917293_270164_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=131 data-flex-basis=316px></p><h3 id=总结-1>总结</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004653315.png width=1865 height=677 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004653315_hu3d20ee6091dde989b9d709a7caf6a4d5_372285_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004653315_hu3d20ee6091dde989b9d709a7caf6a4d5_372285_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=275 data-flex-basis=661px></p><hr><h2 id=tcp的流量控制>TCP的流量控制</h2><h3 id=概念-2>概念</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021223432091.png width=1718 height=519 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021223432091_hu4b1e11ca34fece5d2be364332932775a_308758_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021223432091_hu4b1e11ca34fece5d2be364332932775a_308758_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=331 data-flex-basis=794px></p><p>举例</p><p><a class=link href="https://www.bilibili.com/video/BV1c4411d7jb?p=60" target=_blank rel=noopener>具体流程的视频</a></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231801076.png width=1831 height=716 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231801076_hu2d5722010bc06c3fd8664858bc3d4f35_427037_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231801076_hu2d5722010bc06c3fd8664858bc3d4f35_427037_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=255 data-flex-basis=613px></p><p>上图主机A现在可将发送缓存中序号1~200的字节数据全部删除，因为已经收到了主机B对它们的累计确认</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231904707.png width=1822 height=861 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231904707_hubfe7d9160daa15e0e795018e2d9cf660_767364_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231904707_hubfe7d9160daa15e0e795018e2d9cf660_767364_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=211 data-flex-basis=507px></p><p>上图主机A现在可将发送缓存中序号201~500的字节数据全部删除，因为已经收到了主机B对它们的累计确认</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231945653.png width=1814 height=863 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231945653_hu1f54b0db9e30fbaf4e06f16890f58100_959021_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021231945653_hu1f54b0db9e30fbaf4e06f16890f58100_959021_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=210 data-flex-basis=504px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232027721.png width=1822 height=854 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232027721_hu5b3a0b797738b5e87763420b37a6e5d4_992462_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232027721_hu5b3a0b797738b5e87763420b37a6e5d4_992462_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=213 data-flex-basis=512px></p><p>上图主机A现在可将发送缓存中序号501~600的字节数据全部删除，因为已经收到了主机B对它们的累计确认</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232600497.png width=1901 height=847 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232600497_hue981d06633d7299ed4c62462aa0fe45f_557140_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232600497_hue981d06633d7299ed4c62462aa0fe45f_557140_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=224 data-flex-basis=538px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232645300.png width=1900 height=856 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232645300_hu4bc1581b74d1bb163ce2e52d45702317_795514_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021232645300_hu4bc1581b74d1bb163ce2e52d45702317_795514_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=221 data-flex-basis=532px></p><blockquote><p>上图如果零窗口探测报文在发送过程中如果丢失，还是能打破死锁局面</p><p>因为零窗口探测报文段也有重传计时器，重传计时器超时后，零窗口探测报文段会被重传</p></blockquote><h3 id=总结-2>总结</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021234004254.png width=1754 height=639 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021234004254_hua13feb4308b687f14949e54187a203ff_499922_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021234004254_hua13feb4308b687f14949e54187a203ff_499922_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=274 data-flex-basis=658px></p><hr><h2 id=tcp的拥塞控制>TCP的拥塞控制</h2><h3 id=概念-3>概念</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141057083.png width=1759 height=897 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141057083_hudabf94c50db786bc1def4593a959d64e_591880_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141057083_hudabf94c50db786bc1def4593a959d64e_591880_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=196 data-flex-basis=470px></p><p><strong>网络拥塞往往是由许多因素引起的。例如：</strong></p><ol><li>点缓存的容量太小；</li><li>链路的容量不足；</li><li>处理机处理的速率太慢；</li><li>拥塞本身会进一步加剧拥塞；</li></ol><p><strong>拥塞控制的一般原理</strong></p><ul><li>拥塞控制的前提：网络能够承受现有的网络负荷。</li><li>实践证明，拥塞控制是很难设计的，因为它是一个<strong>动态问题</strong>。</li><li>分组的丢失是网络发生拥塞的<strong>征兆</strong>而不是原因。</li><li>在许多情况下，甚至正是<strong>拥塞控制本身</strong>成为引起网络性能恶化、甚至发生死锁的原因。</li></ul><p><strong>开环控制和闭环控制</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022142108309.png width=884 height=341 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022142108309_hu697a451387335d89b13b70d86e5b6c52_58449_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022142108309_hu697a451387335d89b13b70d86e5b6c52_58449_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=259 data-flex-basis=622px></p><p><strong>监测网络的拥塞</strong></p><p>主要指标有：</p><ol><li>由于缺少缓存空间而被丢弃的分组的百分数；</li><li>平均队列长度；</li><li>超时重传的分组数；</li><li>平均分组时延；</li><li>分组时延的标准差，等等。</li></ol><p>上述这些指标的上升都标志着拥塞的增长。</p><h3 id=拥塞控制的算法>拥塞控制的算法</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141423443.png width=1883 height=613 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141423443_hua25dcf9ef5654d5ccb3b72bcae66c67f_548032_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141423443_hua25dcf9ef5654d5ccb3b72bcae66c67f_548032_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=307 data-flex-basis=737px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141556134.png width=1892 height=779 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141556134_hu93c5ddcae8701fcb45a4519fdb84f8d9_651767_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022141556134_hu93c5ddcae8701fcb45a4519fdb84f8d9_651767_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=242 data-flex-basis=582px></p><blockquote><p>真正的发送窗口值 = Min (接收方窗口值，拥塞窗口值)</p></blockquote><p>下图的实例横纵坐标的意思</p><p>传输轮次：</p><ul><li>发送方给接收方发送数据报文段后，接收方给发送方发发回相应的确认报文段</li><li>一个传输轮次所经历的时间其实就是往返时间，往返时间并非是恒定的数值</li><li>使用传输轮次是为了强调把拥塞窗口所允许发送的报文段都连续发送出去，并受到了对已发送的最后一个报文段的确认</li></ul><p>拥塞窗口：</p><ul><li>它会随网络拥塞程度，以及所使用的拥塞控制算法动态变化</li></ul><h4 id=慢开始和拥塞避免>慢开始和拥塞避免</h4><h5 id=慢开始slow-start>慢开始（slow-start）</h5><ul><li>目的：用来确定网络的负载能力或拥塞程度。</li><li>算法的思路：由小到大逐渐增大拥塞窗口数值。</li><li>两个变量：<ul><li><strong>拥塞窗口（cwnd）</strong>：初始拥塞窗口值：2 种设置方法。窗口值逐渐增大。<ul><li>1 至 2 个最大报文段 （旧标准）</li><li>2 至 4 个最大报文段 （RFC 5681）</li></ul></li><li><strong>慢开始门限（ssthresh）</strong>：防止拥塞窗口增长过大引起网络拥塞。</li></ul></li></ul><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145631052.png width=1884 height=906 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145631052_hu51c0ee98536e96083efe7a1ce05234a5_247738_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145631052_hu51c0ee98536e96083efe7a1ce05234a5_247738_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=207 data-flex-basis=499px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022144725100.png width=713 height=310 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022144725100_hud946acf8fb86a889a6bd59fa87ed8927_43313_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022144725100_hud946acf8fb86a889a6bd59fa87ed8927_43313_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=230 data-flex-basis=552px></p><blockquote><p>图中swnd是发送窗口</p><p>每经过一个传输轮次，拥塞窗口就加倍</p><p>窗口大小按<strong>指数增加</strong>，2的n-1次方</p></blockquote><h5 id=拥塞避免congestion-avoidance>拥塞避免（congestion avoidance）</h5><ul><li>思路：让拥塞窗口 cwnd <strong>缓慢地增大</strong>，避免出现拥塞。</li><li>每经过一个传输轮次，拥塞窗口 <strong>cwnd = cwnd + 1</strong>。</li><li>使拥塞窗口 cwnd 按线性规律缓慢增长。</li><li>在拥塞避免阶段，具有 “<strong>加法增大</strong>” (Additive Increase) 的特点。</li></ul><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150143886.png width=1898 height=906 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150143886_hu2802ecea5f514c0bdf76172460cccfd4_274785_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150143886_hu2802ecea5f514c0bdf76172460cccfd4_274785_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=209 data-flex-basis=502px></p><p>如果在发送过程中出现部分报文段丢失，这必然会造成发送方对这些丢失报文段的超时重传</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145749592.png width=1896 height=916 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145749592_hu5f03d3836578c87429b54df652b368fe_537806_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145749592_hu5f03d3836578c87429b54df652b368fe_537806_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=206 data-flex-basis=496px></p><p>这个时候又回到了慢开始</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145544163.png width=1894 height=914 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145544163_hu4ca9bc3eb836d9a8acf22d339491909f_326266_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145544163_hu4ca9bc3eb836d9a8acf22d339491909f_326266_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=207 data-flex-basis=497px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145824004.png width=1890 height=966 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145824004_hubb841f6b3b43f5eebbb7823b15276697_383854_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022145824004_hubb841f6b3b43f5eebbb7823b15276697_383854_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=195 data-flex-basis=469px></p><h5 id=两个算法完整示意图>两个算法完整示意图</h5><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150236926.png width=1908 height=898 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150236926_hue9557b68f9d3dc6694ca51ef1cdf1e4d_653344_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150236926_hue9557b68f9d3dc6694ca51ef1cdf1e4d_653344_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=212 data-flex-basis=509px></p><h4 id=快重传和快恢复>快重传和快恢复</h4><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150902709.png width=1214 height=798 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150902709_hu7a71e92cfb28cb9fc8fb7cc589ab617f_518714_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022150902709_hu7a71e92cfb28cb9fc8fb7cc589ab617f_518714_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=152 data-flex-basis=365px></p><h5 id=快重传fast-retrasmit>快重传（fast retrasmit）</h5><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151250183.png width=1869 height=783 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151250183_hu3b1f2c3cd2a53242a9dc21846ea204c6_748777_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151250183_hu3b1f2c3cd2a53242a9dc21846ea204c6_748777_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=238 data-flex-basis=572px></p><h5 id=快恢复fast-recovery>快恢复（fast recovery）</h5><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151819265.png width=1801 height=369 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151819265_huea6553c8c4dc878e41d7590574099c75_498714_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022151819265_huea6553c8c4dc878e41d7590574099c75_498714_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=488 data-flex-basis=1171px></p><h5 id=改进后的整体算法的示意图>改进后的整体算法的示意图</h5><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152041751.png width=1907 height=881 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152041751_huc1521e627b0302b27d2af832f730cd0a_631541_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152041751_huc1521e627b0302b27d2af832f730cd0a_631541_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=216 data-flex-basis=519px></p><hr><h2 id=tcp超时重传时间的选择>TCP超时重传时间的选择</h2><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152651184.png width=1837 height=892 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152651184_huc18ca2678a541462d763bd6360c84d13_353832_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152651184_huc18ca2678a541462d763bd6360c84d13_353832_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=205 data-flex-basis=494px></p><blockquote><p>如果超时重传时间RTO的值设置得比RTT0的值小很多，这会引起报文段不必要的重传，使网络负荷增大</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152708875.png width=1748 height=890 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152708875_huae6d005b600078f8b8932d3afa6b1332_383011_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152708875_huae6d005b600078f8b8932d3afa6b1332_383011_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=196 data-flex-basis=471px></p><blockquote><p>如果超时重传时间RTO的值设置得远大于RTT0的值，这会使重传时间推迟的太长，使网络的空闲时间增大，降低传输效率</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153244047.png width=1524 height=798 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153244047_hub7ac29113bd3324c99fc0319fbe155fc_269485_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153244047_hub7ac29113bd3324c99fc0319fbe155fc_269485_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=190 data-flex-basis=458px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153518218.png width=1901 height=896 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153518218_hu3967c1e0c5bf9863aabcbb16ae06c6c9_737691_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153518218_hu3967c1e0c5bf9863aabcbb16ae06c6c9_737691_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=212 data-flex-basis=509px></p><p><strong>RFC6298建议使用下式计算超时重传时间RTO</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153758413.png width=1910 height=838 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153758413_hu2af7b7cdb96301b0c9295ec54e332a42_536080_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022153758413_hu2af7b7cdb96301b0c9295ec54e332a42_536080_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=227 data-flex-basis=547px></p><p><strong>往返时间RTT的测量比较复杂</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154045440.png width=1864 height=820 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154045440_hu6419017745766914956fa2a2392e1b11_661137_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154045440_hu6419017745766914956fa2a2392e1b11_661137_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=227 data-flex-basis=545px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154137911.png width=1849 height=736 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154137911_hud179f1d732f0a0ca7fa66518327f8b4f_913481_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154137911_hud179f1d732f0a0ca7fa66518327f8b4f_913481_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=251 data-flex-basis=602px></p><p><strong>TCP超时重传的计算</strong></p><p>举例</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154350745.png width=1918 height=910 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154350745_hua63aff9457e97a77f9217cd89c08760a_605897_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154350745_hua63aff9457e97a77f9217cd89c08760a_605897_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=210 data-flex-basis=505px></p><p><strong>总结</strong></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154418863.png width=1889 height=842 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154418863_hu1c394c2e2db6408555c65579eb3f6e8f_621628_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022154418863_hu1c394c2e2db6408555c65579eb3f6e8f_621628_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=224 data-flex-basis=538px></p><hr><h2 id=tcp可靠传输的实现>TCP可靠传输的实现</h2><p><a class=link href="https://www.bilibili.com/video/BV1c4411d7jb?p=63" target=_blank rel=noopener>本集具体讲解</a></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161436801.png width=1869 height=893 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161436801_hu5ad5721ee965def6ff10fd80277cc0b8_481838_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161436801_hu5ad5721ee965def6ff10fd80277cc0b8_481838_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=209 data-flex-basis=502px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161734997.png width=1887 height=824 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161734997_hu334731c395dfed33730a94e93491e281_501722_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022161734997_hu334731c395dfed33730a94e93491e281_501722_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=229 data-flex-basis=549px></p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164339902.png width=1846 height=897 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164339902_hu33fdc580c7bbe6ae7e8a01301bc36f41_984189_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164339902_hu33fdc580c7bbe6ae7e8a01301bc36f41_984189_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=205 data-flex-basis=493px></p><hr><h2 id=tcp的运输连接管理>TCP的运输连接管理</h2><h3 id=概念-4>概念</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193215183.png width=1747 height=843 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193215183_hu918b716181c85b72935e9f094488c6c1_342157_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193215183_hu918b716181c85b72935e9f094488c6c1_342157_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=207 data-flex-basis=497px></p><h3 id=tcp的连接建立>TCP的连接建立</h3><ul><li>TCP 建立连接的过程叫做<strong>握手</strong>。</li><li>握手需要在客户和服务器之间交换三个 TCP 报文段。称之为<strong>三报文握手</strong>。</li><li>采用<strong>三报文握手</strong>主要是为了防止已失效的连接请求报文段突然又传送到了，因而产生错误。</li></ul><h4 id=tcp的连接建立要解决以下三个问题>TCP的连接建立要解决以下三个问题</h4><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193418673.png width=1824 height=377 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193418673_huf42ce3cce581008ff5c2da4e02a20151_195421_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022193418673_huf42ce3cce581008ff5c2da4e02a20151_195421_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=483 data-flex-basis=1161px></p><h4 id=tcp使用三报文握手建立连接>TCP使用“三报文握手”建立连接</h4><ul><li>TCP 连接的建立<strong>采用客户服务器方式</strong>。</li><li>主动发起连接建立的应用进程叫做<strong>TCP客户</strong> (client)。</li><li>被动等待连接建立的应用进程叫做<strong>TCP服务器</strong> (server)。</li></ul><p>“握手”需要在TCP客户端和服务器之间交换三个TCP报文段</p><p>过程</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194219693.png width=1350 height=278 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194219693_hua9ac730338681ab5b9fa5f0ba8809609_57516_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194219693_hua9ac730338681ab5b9fa5f0ba8809609_57516_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=485 data-flex-basis=1165px></p><blockquote><p>最初两端的TCP进程都处于关闭状态</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194350899.png width=1868 height=535 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194350899_hu94d289ef27e368387bcdf63ccbbc5043_290497_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194350899_hu94d289ef27e368387bcdf63ccbbc5043_290497_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=349 data-flex-basis=837px></p><blockquote><p>一开始，TCP服务器进程首先创建传输控制块，用来存储TCP连接中的一些重要信息。例如TCP连接表、指向发送和接收缓存的指针、指向重传队列的指针，当前的发送和接收序号等</p><p>之后，就准备接受TCP客户端进程的连接请求</p><p>此时，TCP服务器进程就进入监听状态，等待TCP客户端进程的连接请求</p></blockquote><p>TCP服务器进程是被动等待来自TCP客户端进程的连接请求，因此成为<strong>被动打开</strong>连接</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194926877.png width=1855 height=425 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194926877_hua8b7617475cfc7a8c3e103ea5a13c367_184536_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022194926877_hua8b7617475cfc7a8c3e103ea5a13c367_184536_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=436 data-flex-basis=1047px></p><blockquote><p>TCP客户进程也是首先创建传输控制块</p></blockquote><p>由于TCP连接建立是由TCP客户端主动发起的，因此称为<strong>主动打开</strong>连接</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195108616.png width=1870 height=562 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195108616_hu6e0aa3fb35c58e6451bd849080a51a26_172900_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195108616_hu6e0aa3fb35c58e6451bd849080a51a26_172900_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=332 data-flex-basis=798px></p><blockquote><p>然后，在打算建立TCP连接时，向TCP服务器进程发送TCP连接请求报文段，并进入同步已发送状态</p><p>TCP连接请求报文段首部中</p><ul><li>同步位SYN被设置为1，表明这是一个TCP连接请求报文段</li><li>序号字段seq被设置了一个初始值x，作为TCP客户端进程所选择的初始序号</li></ul><p>请注意：TCP规定SYN被设置为1的报文段不能携带数据，但要消耗掉一个序号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195847144.png width=1907 height=691 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195847144_huc64770ecb07fd4936a7aa434949c6a56_289379_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022195847144_huc64770ecb07fd4936a7aa434949c6a56_289379_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=275 data-flex-basis=662px></p><blockquote><p>TCP服务器进程收到TCP连接请求报文段后，如果同意建立连接，则向TCP客户进程发送TCP连接请求确认报文段，并进入同步已接收状态</p><p>TCP连接请求确认报文段首部中</p><ul><li>同步位SYN和确认为ACK都设置为1，表明这是一个TCP连接请求确认报文段</li><li>序号字段seq被设置了一个初始值y，作为TCP服务器进程所选择的初始序号，</li><li>确认号字段ack的值被设置成了x+1，这是对TCP客户进程所选择的初始序号（seq）的确认</li></ul><p>请注意：这个报文段也不能携带数据，因为它是SYN被设置为1的报文段，但同样要消耗掉一个序号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202010182.png width=1901 height=819 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202010182_hudee39a9e45b845b39e46cbe6c8e6d7b5_432423_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202010182_hudee39a9e45b845b39e46cbe6c8e6d7b5_432423_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=232 data-flex-basis=557px></p><blockquote><p>TCP客户进程收到TCP连接请求确认报文段后，还要向TCP服务器进程发送一个普通的TCP确认报文段，并进入连接已连接状态</p><p>普通的TCP确认报文段首部中</p><ul><li>确认位ACK被设置为1，表明这是一个普通的TCP确认报文段</li><li>序号字段seq被设置为x+1，这是因为TCP客户进程发送的第一个TCP报文段的序号为x，所以TCP客户进程发送的第二个报文段的序号为x+1</li><li>确认号字段ack被设置为y+1，这是对TCP服务器进程所选择的初始序号的确认</li></ul><p>请注意：TCP规定普通的TCP确认报文段可以携带数据，但如果不携带数据，则不消耗序号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202932905.png width=1905 height=819 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202932905_hu2b1e590267eaf6e33877beea9f7c9e63_465786_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022202932905_hu2b1e590267eaf6e33877beea9f7c9e63_465786_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=232 data-flex-basis=558px></p><blockquote><p>TCP服务器进程收到该确认报文段后也进入连接已建立状态</p><p>现在，TCP双方都进入了连接已建立状态，它们可以基于已建立好的TCP连接，进行可靠的数据传输</p></blockquote><p>为什么TCP客户进程最后还要发送一个普通的TCP确认报文段？能否使用“两报文握手”建立连接？</p><p>下图实例是“两报文握手”</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022203744174.png width=1866 height=898 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022203744174_hu646580974db3c268bf90cce9b9a0bbb3_404671_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022203744174_hu646580974db3c268bf90cce9b9a0bbb3_404671_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=207 data-flex-basis=498px></p><blockquote><p>为了防止已经失效的连接请求报文段突然又传到服务端，因而产生错误”，这种情况是：一端(client)A发出去的第一个连接请求报文并没有> 丢失，而是因为某些未知的原因在某个网络节点上发生滞留，导致延迟到连接释放以后的某个时间才到达另一端(server)B。本来这是一个> 早已失效的报文段，但是B收到此失效的报文之后，会误认为是A再次发出的一个新的连接请求，于是B端就向A又发出确认报文，表示同> 意建立连接。如果不采用“三次握手”，那么只要B端发出确认报文就会认为新的连接已经建立了，但是A端并没有发出建立连接的请求，因> 此不会去向B端发送数据，B端没有收到数据就会一直等待，这样B端就会白白浪费掉很多资源。</p><p>所以并不<strong>多余</strong>，这是为了防止已失效的连接请求报文段突然又传送到了TCP服务器，因而导致错误</p></blockquote><h4 id=总结-3>总结</h4><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204422775.png width=1906 height=902 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204422775_hu1a1699b1c7f86c37f1c4bc9682c9f709_833405_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204422775_hu1a1699b1c7f86c37f1c4bc9682c9f709_833405_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=211 data-flex-basis=507px></p><h3 id=tcp的连接释放>TCP的连接释放</h3><ul><li>TCP 连接释放过程比较复杂。</li><li>数据传输结束后，通信的双方都可释放连接。</li><li>TCP 连接释放过程是<strong>四报文握手</strong>。</li></ul><h4 id=tcp通过四报文挥手来释放连接>TCP通过“四报文挥手”来释放连接</h4><ul><li>TCP 连接的建立<strong>采用客户服务器方式</strong>。</li><li>主动发起连接建立的应用进程叫做<strong>TCP客户</strong> (client)。</li><li>被动等待连接建立的应用进程叫做<strong>TCP服务器</strong> (server)。</li><li><strong>任何一方都可以在数据传送结束后发出连接释放的通知</strong></li></ul><p>过程</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022205124204.png width=1772 height=433 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022205124204_hu491854e7f1d9508d99b3e14ec6cf4f9a_191170_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022205124204_hu491854e7f1d9508d99b3e14ec6cf4f9a_191170_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=409 data-flex-basis=982px></p><blockquote><p>现在TCP客户进程和TCP服务器进程都处于连接已建立状态</p><p>TCP客户进程的应用进程通知其主动关闭TCP连接</p><p>TCP客户进程会发送TCP连接释放报文段，并进入终止等待1状态</p><p>TCP连接释放报文段首部中</p><ul><li>终止位FIN和确认为ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li><li>序号seq字段的值设置为u，它等于TCP客户进程之前已传送过的数据的最后一个字节的序号加1</li><li>确认号ack字段的值设置为v，它等于TCP客户进程之前已收到的、数据的最后一个字节的序号加1</li></ul><p>请注意：TCP规定终止位FIN等于1的报文段即使不携带数据，也要消耗掉一个序号</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022210030419.png width=1863 height=518 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022210030419_hu3183773ead21420591227a9ff76d2b26_308289_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022210030419_hu3183773ead21420591227a9ff76d2b26_308289_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=359 data-flex-basis=863px></p><blockquote><p>TCP服务器进程收到TCP连接释放报文段后，会发送一个普通的TCP确认报文段并进入关闭等待状态</p><p>普通的TCP确认报文段首部中</p><ul><li>确认位ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li><li>序号seq字段的值设置为v，它等于TCP服务器进程之前已传送过的数据的最后一个字节的序号加1，这也与之前收到的TCP连接释放报文段中的确认号匹配</li><li>确认号ack字段的值设置为u+1，这是对TCP连接释放报文段的确认</li></ul></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022232158631.png width=1785 height=455 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022232158631_huda99ac90f6a3412f2a02fa7a2526067d_281516_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022232158631_huda99ac90f6a3412f2a02fa7a2526067d_281516_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=392 data-flex-basis=941px></p><blockquote><p>TCP服务器进程应该通知高层应用进程，TCP客户进程要断开与自己的TCP连接</p><p>此时，从TCP客户进程到TCP服务器进程这个方向的连接就释放了</p><p>这时的TCP连接属于半关闭状态，也就是TCP客户进程已经没有数据要发送了</p><p>但如果TCP服务器进程还有数据要发送，TCP客户进程仍要接收，也就是说从TCP服务器进程到TCP客户进程这个方向的连接并未关闭</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233050922.png width=1896 height=574 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233050922_hu457a03bd3a97b19e19a5dc6ab01b87d5_352700_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233050922_hu457a03bd3a97b19e19a5dc6ab01b87d5_352700_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=330 data-flex-basis=792px></p><blockquote><p>TCP客户进程收到TCP确认报文段后就进入终止等待2状态，等待TCP服务器进程发出的TCP连接释放报文段</p><p>若使用TCP服务器进程的应用进程已经没有数据要发送了，应用进程就通知其TCP服务器进程释放连接</p><p>由于TCP连接释放是由TCP客户进程主动发起的，因此TCP服务器进程对TCP连接的释放称为被动关闭连接</p></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233941557.png width=1835 height=605 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233941557_hu18df7a5aa874e8995866d6f4279a1696_434538_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022233941557_hu18df7a5aa874e8995866d6f4279a1696_434538_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=303 data-flex-basis=727px></p><blockquote><p>TCP服务器进程发送TCP连接释放报文段并进入最后确认状态</p><p>该报文段首部中</p><ul><li>终止位FIN和确认位ACK的值都被设置为1，表明这是一个TCP连接释放报文段，同时也对之前收到的报文段进行确认</li><li>序号seq字段的值为w，这是因为在半关闭状态下，TCP服务器进程可能又发送</li><li>确认号ack字段的值为u+1，这是对之前收到的TCP连接释放报文段的重复确认</li></ul></blockquote><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234741310.png width=1867 height=826 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234741310_huc65dc339d95b1bdadbd718d3ad00c486_651058_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234741310_huc65dc339d95b1bdadbd718d3ad00c486_651058_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=226 data-flex-basis=542px></p><blockquote><p>TCP客户进程收到TCP连接释放报文段后，必须针对该报文段发送普通的TCP确认报文段，之后进入时间等待状态</p><p>该报文段首部中</p><ul><li>确认为ACK的值被设置为1，表明这是一个普通的TCP确认报文段</li><li>序号seq字段的值设置为u+1，这是因为TCP客户进程之前发送的TCP连接释放报文段虽然不携带数据，但要消耗掉一个序号</li><li>确认号ack字段的值设置为w+1，这是对所收到的TCP连接释放报文段的确认</li></ul><p>TCP服务器进程收到该报文段后就进入关闭状态，而TCP客户进程还要进过2MSL后才能进入关闭状态</p></blockquote><p>TCP客户进程在发送完最后一个确认报文后，为什么不直接进入关闭状态？而是要进入时间等待状态？</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234942562.png width=1896 height=841 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234942562_hu2a4e99c0ae9bddc429eb398ef213866d_689747_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022234942562_hu2a4e99c0ae9bddc429eb398ef213866d_689747_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=225 data-flex-basis=541px></p><blockquote><p>因为时间等待状态以及处于该状态2MSL时长，可以确保TCP服务器进程可以收到最后一个TCP确认报文段而进入关闭状态</p><p>另外，TCP客户进程在发送完最后一个TCP确认报文段后，在经过2MSL时长，就可以使本次连接持续时间内所产生的所有报文段都从网络中消失，这样就可以使下一个新的TCP连接中，不会出现旧连接中的报文段</p></blockquote><h4 id=tcp保活计时器的作用>TCP保活计时器的作用</h4><p>TCP双方已经建立了连接，后来，TCP客户进程所在的主机突然出现了故障</p><p>TCP服务器进程以后就不能再收到TCP客户进程发来的数据</p><p>因此，应当有措施使TCP服务器进程不要再白白等待下去</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022235800155.png width=1860 height=776 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022235800155_hub31fc6424f05e8b6963549d359f504bc_566586_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022235800155_hub31fc6424f05e8b6963549d359f504bc_566586_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=239 data-flex-basis=575px></p><hr><h2 id=tcp报文段的首部格式>TCP报文段的首部格式</h2><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023000859363.png width=1880 height=750 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023000859363_hu7696e4bd720362cb3e627c7b69738a56_469184_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023000859363_hu7696e4bd720362cb3e627c7b69738a56_469184_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=250 data-flex-basis=601px></p><h3 id=各字段的作用>各字段的作用</h3><p>源端口和目的端口</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005210010.png width=1206 height=1103 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005210010_hue2721795434aaa4514c69aac8b0fdcb9_322215_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005210010_hue2721795434aaa4514c69aac8b0fdcb9_322215_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=109 data-flex-basis=262px></p><p>序号、确认号和确认标志位</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023003826059.png width=1206 height=1083 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023003826059_hu28169d05196122fc1a73d0cc3b15e7dd_541969_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023003826059_hu28169d05196122fc1a73d0cc3b15e7dd_541969_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=111 data-flex-basis=267px></p><p>数据偏移、保留、窗口和校验和</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004227265.png width=1250 height=1170 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004227265_hu055c6183076cae6e995beb9722bc8530_600594_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023004227265_hu055c6183076cae6e995beb9722bc8530_600594_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=106 data-flex-basis=256px></p><p>同步标志位、终止标志位、复位标志位、推送标志位、紧急标志位和紧急指针</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005001450.png width=1225 height=1167 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005001450_hu7025e59ee28bfc3d7f6f7b335a195ae5_692210_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005001450_hu7025e59ee28bfc3d7f6f7b335a195ae5_692210_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=104 data-flex-basis=251px></p><p>选项和填充</p><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005132426.png width=1185 height=797 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005132426_hue3f0dfff86368d6aa057a4cd3417b89d_305133_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201023005132426_hue3f0dfff86368d6aa057a4cd3417b89d_305133_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=148 data-flex-basis=356px></p><h2 id=习题>习题</h2><h3 id=tcp的流量控制-1>TCP的流量控制</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021233918057.png width=1836 height=909 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021233918057_hu1773e52f548aa90cf7ee3164f4736bb8_554826_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201021233918057_hu1773e52f548aa90cf7ee3164f4736bb8_554826_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=201 data-flex-basis=484px></p><h3 id=tcp的拥塞控制-1>TCP的拥塞控制</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152255103.png width=1874 height=907 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152255103_hueb7b330b78e0119d5c20d3c3c9579aeb_703577_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022152255103_hueb7b330b78e0119d5c20d3c3c9579aeb_703577_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=206 data-flex-basis=495px></p><h3 id=tcp可靠传输的实现-1>TCP可靠传输的实现</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022163045361.png width=1885 height=905 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022163045361_hu07a75b48f50db80ef11c1a6ec7f07827_486705_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022163045361_hu07a75b48f50db80ef11c1a6ec7f07827_486705_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=208 data-flex-basis=499px></p><hr><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164057627.png width=1887 height=906 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164057627_hu1c64abc088832ba03e15aedf8f0f483a_589290_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022164057627_hu1c64abc088832ba03e15aedf8f0f483a_589290_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=208 data-flex-basis=499px></p><h3 id=tcp的运输连接管理-1>TCP的运输连接管理</h3><p><img src=/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204336098.png width=1869 height=893 srcset="/p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204336098_hu8f87f80126b8fcabd56d9c8e6876d97d_683933_480x0_resize_box_3.png 480w, /p/v-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E8%BF%90%E8%BE%93%E5%B1%82/image-20201022204336098_hu8f87f80126b8fcabd56d9c8e6876d97d_683933_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=209 data-flex-basis=502px></p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/>计算机网络微课堂笔记</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/i-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E6%A6%82%E8%BF%B0/><div class=article-details><h2 class=article-title>I: 计算机网络微课堂-概述</h2></div></a></article><article><a href=/p/ii-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E7%89%A9%E7%90%86%E5%B1%82/><div class=article-details><h2 class=article-title>II: 计算机网络微课堂-物理层</h2></div></a></article><article><a href=/p/iii-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/><div class=article-details><h2 class=article-title>III: 计算机网络微课堂-数据链路层</h2></div></a></article><article><a href=/p/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E7%BD%91%E7%BB%9C%E5%B1%82/><div class=article-details><h2 class=article-title>Ⅳ: 计算机网络微课堂-网络层</h2></div></a></article><article><a href=/p/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%BE%AE%E8%AF%BE%E5%A0%82-%E5%BA%94%E7%94%A8%E5%B1%82/><div class=article-details><h2 class=article-title>Ⅵ: 计算机网络微课堂-应用层</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 importzhh的小破站</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>